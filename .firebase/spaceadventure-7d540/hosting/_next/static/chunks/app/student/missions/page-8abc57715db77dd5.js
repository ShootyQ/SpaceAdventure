(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[230],{1910:function(e,t,s){Promise.resolve().then(s.bind(s,456))},456:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return y}});var a=s(3827),r=s(4090),n=s(8121),l=s(4499),i=s(6678),c=s(8994),o=s(3879),d=s(9369),x=s(4562),u=s(6260),h=s(1472),m=s(6578),p=s(1483),b=s(8792),g=s(7907),f=s(4832);function y(){let{user:e,userData:t}=(0,i.useAuth)();(0,g.useRouter)();let[s,y]=(0,r.useState)([]),[j,v]=(0,r.useState)(!0),[w,N]=(0,r.useState)(null),[k,C]=(0,r.useState)({}),[S,I]=(0,r.useState)([]),[R,Z]=(0,r.useState)(!1),[A,z]=(0,r.useState)(null);(0,r.useEffect)(()=>{(async()=>{if(e&&t){try{let e;e=t.teacherId?(0,n.IO)((0,n.hJ)(l.db,"users/".concat(t.teacherId,"/missions")),(0,n.Xo)("createdAt","desc")):(0,n.IO)((0,n.hJ)(l.db,"missions"),(0,n.Xo)("createdAt","desc"));let s=(await (0,n.PL)(e)).docs.map(e=>({id:e.id,...e.data()}));y(s);let a=(null==t?void 0:t.completedMissions)||[];I(a)}catch(e){console.error("Error loading missions:",e)}v(!1)}})()},[e,t]);let L=e=>{N(e),C({}),z(null),window.scrollTo(0,0)},M=(e,t)=>{C(s=>({...s,[e]:t}))},P=async()=>{if(w&&e){Z(!0);try{let t=0,s=w.questions.length;w.questions.forEach(e=>{k[e.id]===e.correctAnswer&&t++});let a=Math.round(t/s*100),r=a>=70;if(z({correct:r,score:a}),r){let t=(0,n.JU)(l.db,"users",e.uid);S.includes(w.id)||(await (0,n.r7)(t,{completedMissions:(0,n.vr)(w.id),xp:(0,n.nP)(w.xpReward)}),(0,f.Z)({particleCount:150,spread:70,origin:{y:.6}}),I(e=>[...e,w.id]))}}catch(e){console.error("Error submitting mission:",e),alert("Error submitting mission. Please try again.")}Z(!1)}};return j?(0,a.jsx)("div",{className:"min-h-screen bg-black flex items-center justify-center text-cyan-500",children:(0,a.jsx)(c.Z,{size:40,className:"animate-spin"})}):w?(S.includes(w.id),(0,a.jsx)("div",{className:"min-h-screen bg-space-950 p-6 font-mono text-cyan-400",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto pb-20",children:[(0,a.jsxs)("button",{onClick:()=>N(null),className:"flex items-center gap-2 text-cyan-600 hover:text-cyan-400 mb-6 transition-colors",children:[(0,a.jsx)(o.Z,{size:20}),"Back to Mission Log"]}),(0,a.jsxs)("div",{className:"bg-black/80 border border-cyan-500/30 rounded-2xl overflow-hidden backdrop-blur-sm",children:[(0,a.jsxs)("div",{className:"p-8 border-b border-cyan-900/50 bg-gradient-to-r from-cyan-950/50 to-transparent",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,a.jsxs)("span",{className:"inline-flex items-center gap-2 px-3 py-1 bg-cyan-500/10 text-cyan-300 rounded text-xs font-bold uppercase tracking-wider border border-cyan-500/20",children:["watch"===w.type?(0,a.jsx)(d.Z,{size:14}):(0,a.jsx)(x.Z,{size:14}),"watch"===w.type?"Video Log":"Intel Report"]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-yellow-400 font-bold",children:[(0,a.jsx)(u.Z,{size:18}),(0,a.jsxs)("span",{children:[w.xpReward," XP"]})]})]}),(0,a.jsx)("h1",{className:"text-3xl font-bold text-white mb-2",children:w.title}),(0,a.jsx)("p",{className:"text-cyan-200/80",children:w.description})]}),(0,a.jsxs)("div",{className:"p-8",children:["watch"===w.type&&w.contentUrl&&(0,a.jsx)("div",{className:"aspect-video w-full bg-black rounded-xl overflow-hidden border border-cyan-900 mb-8",children:(0,a.jsx)("iframe",{src:w.contentUrl.replace("watch?v=","embed/"),className:"w-full h-full",allowFullScreen:!0,title:"Mission Briefing"})}),"read"===w.type&&w.contentText&&(0,a.jsx)("div",{className:"prose prose-invert prose-cyan max-w-none mb-8 p-6 bg-cyan-950/20 rounded-xl border border-cyan-900/30",children:(0,a.jsx)("div",{className:"whitespace-pre-wrap font-sans text-gray-300 leading-relaxed text-lg",children:w.contentText})}),(0,a.jsxs)("div",{className:"mt-12",children:[(0,a.jsxs)("h3",{className:"flex items-center gap-2 text-xl font-bold text-white mb-6 pb-2 border-b border-cyan-900",children:[(0,a.jsx)(h.Z,{className:"text-purple-400"}),"Knowledge Check"]}),(0,a.jsx)("div",{className:"space-y-8",children:w.questions.map((e,t)=>{var s;return(0,a.jsxs)("div",{className:"p-6 bg-black/40 rounded-xl border border-cyan-900/30",children:[(0,a.jsxs)("p",{className:"font-bold text-white mb-4 text-lg",children:[(0,a.jsxs)("span",{className:"text-cyan-600 mr-2",children:[t+1,"."]}),e.text]}),(0,a.jsxs)("div",{className:"space-y-3",children:["tf"===e.type&&(0,a.jsx)("div",{className:"flex gap-4",children:["true","false"].map(t=>(0,a.jsxs)("label",{className:"\n                                                                flex-1 cursor-pointer p-4 rounded-lg border transition-all\n                                                                ".concat(k[e.id]===t?"bg-cyan-900/40 border-cyan-500 text-white":"bg-black/20 border-white/10 hover:bg-white/5 text-gray-400","\n                                                            "),children:[(0,a.jsx)("input",{type:"radio",name:e.id,value:t,checked:k[e.id]===t,onChange:t=>M(e.id,t.target.value),className:"hidden"}),(0,a.jsx)("span",{className:"capitalize font-bold text-center block",children:t})]},t))}),"mc"===e.type&&(null===(s=e.options)||void 0===s?void 0:s.map(t=>(0,a.jsxs)("label",{className:"\n                                                        block cursor-pointer p-4 rounded-lg border transition-all\n                                                        ".concat(k[e.id]===t?"bg-cyan-900/40 border-cyan-500 text-white":"bg-black/20 border-white/10 hover:bg-white/5 text-gray-400","\n                                                    "),children:[(0,a.jsx)("input",{type:"radio",name:e.id,value:t,checked:k[e.id]===t,onChange:t=>M(e.id,t.target.value),className:"hidden"}),(0,a.jsx)("span",{className:"md:text-lg",children:t})]},t)))]})]},e.id)})})]}),A&&(0,a.jsx)("div",{className:"mt-8 p-6 rounded-xl text-center border-2 animate-in zoom-in duration-300 ".concat(A.correct?"bg-green-900/20 border-green-500":"bg-red-900/20 border-red-500"),children:A.correct?(0,a.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,a.jsx)(m.Z,{className:"text-green-500 w-16 h-16 mb-2"}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Mission Accomplished!"}),(0,a.jsxs)("p",{className:"text-green-300",children:["Score: ",A.score,"% - You have earned ",w.xpReward," XP."]}),(0,a.jsx)("button",{onClick:()=>N(null),className:"mt-4 px-6 py-2 bg-green-600 rounded-full font-bold text-white hover:bg-green-500",children:"Return to Base"})]}):(0,a.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,a.jsx)(p.Z,{className:"text-red-500 w-16 h-16 mb-2"}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Mission Failed"}),(0,a.jsxs)("p",{className:"text-red-300",children:["Score: ",A.score,"% - Minimum 70% required."]}),(0,a.jsx)("button",{onClick:()=>z(null),className:"mt-4 px-6 py-2 bg-red-900/50 rounded-full font-bold text-red-200 hover:bg-red-900 border border-red-500/30",children:"Review Intel & Try Again"})]})}),!A&&(0,a.jsx)("button",{onClick:P,disabled:R||Object.keys(k).length<w.questions.length,className:"\n                                        w-full mt-8 py-4 rounded-xl font-bold text-xl uppercase tracking-widest transition-all\n                                        ".concat(Object.keys(k).length<w.questions.length?"bg-gray-800 text-gray-500 cursor-not-allowed":"bg-gradient-to-r from-cyan-600 to-blue-600 hover:from-cyan-500 hover:to-blue-500 text-white shadow-lg shadow-cyan-900/50","\n                                    "),children:R?(0,a.jsx)(c.Z,{className:"animate-spin mx-auto"}):"Transmit Mission Data"})]})]})]})})):(0,a.jsx)("div",{className:"min-h-screen bg-space-950 p-6 font-mono text-cyan-400",children:(0,a.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4 mb-8",children:[(0,a.jsx)(b.default,{href:"/student",className:"p-2 rounded-full border border-cyan-500/30 hover:bg-cyan-900/20 text-cyan-500",children:(0,a.jsx)(o.Z,{size:20})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold uppercase tracking-widest text-white",children:"Mission Log"}),(0,a.jsx)("p",{className:"text-cyan-600",children:"Active Directives & Available Contracts"})]})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(e=>{let t=S.includes(e.id);return(0,a.jsxs)("div",{onClick:()=>L(e),className:"\n                                    relative group p-6 rounded-xl border transition-all cursor-pointer overflow-hidden\n                                    ".concat(t?"bg-green-950/10 border-green-500/30 hover:border-green-500":"bg-black/60 border-cyan-900/50 hover:border-cyan-400 hover:shadow-[0_0_20px_rgba(34,211,238,0.2)]","\n                                "),children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,a.jsx)("div",{className:"p-3 rounded-lg ".concat("watch"===e.type?"bg-purple-900/20 text-purple-400":"bg-blue-900/20 text-blue-400"),children:"watch"===e.type?(0,a.jsx)(d.Z,{size:24}):(0,a.jsx)(x.Z,{size:24})}),t?(0,a.jsxs)("span",{className:"flex items-center gap-1 text-green-400 font-bold bg-green-900/20 px-3 py-1 rounded-full border border-green-500/30 text-xs uppercase",children:[(0,a.jsx)(m.Z,{size:14})," Completed"]}):(0,a.jsxs)("span",{className:"flex items-center gap-1 text-yellow-400 font-bold bg-yellow-900/20 px-3 py-1 rounded-full border border-yellow-500/30 text-xs uppercase",children:[(0,a.jsx)(u.Z,{size:14})," ",e.xpReward," XP"]})]}),(0,a.jsx)("h3",{className:"text-xl font-bold text-white mb-2 line-clamp-1 group-hover:text-cyan-300 transition-colors",children:e.title}),(0,a.jsx)("p",{className:"text-sm text-gray-400 line-clamp-2 mb-4",children:e.description}),(0,a.jsxs)("div",{className:"text-xs text-cyan-700 font-bold uppercase tracking-wider flex items-center gap-2",children:[t?"Review Data":"Click to Initiate",(0,a.jsx)(o.Z,{className:"rotate-180",size:12})]})]},e.id)})})]})})}},6678:function(e,t,s){"use strict";s.r(t),s.d(t,{AuthProvider:function(){return x},useAuth:function(){return u}});var a=s(3827),r=s(4090),n=s(7065),l=s(8121),i=s(4499),c=s(7907),o=s(1657);let d=(0,r.createContext)({});function x(e){let{children:t}=e,[s,x]=(0,r.useState)(null),[u,h]=(0,r.useState)(null),[m,p]=(0,r.useState)(!0),b=(0,c.useRouter)();(0,r.useEffect)(()=>{let e=(0,n.Aj)(i.I8,async e=>{if(x(e),e)try{let s=(0,l.JU)(i.db,"users",e.uid),a=await (0,l.QT)(s);if(a.exists()){let t=a.data(),r="andrewpcarlson85@gmail.com"===e.email,n={};if(r&&"teacher"!==t.role&&(console.log("Fixing Admin Role for Legacy User"),t.role="teacher",n.role="teacher"),"teacher"===t.role&&!t.classCode){console.log("Generating Class Code for existing teacher");let e=(0,o.a)();t.classCode=e,n.classCode=e}if(Object.keys(n).length>0)try{await (0,l.pl)(s,n,{merge:!0})}catch(e){console.warn("Could not update user profile in DB",e)}h(t)}else{var t;e.email;let a={uid:e.uid,email:e.email,displayName:e.displayName,photoURL:e.photoURL,role:"teacher",classCode:(0,o.a)(),status:"active",subscriptionStatus:"trial",schoolName:"",location:"earth",spaceship:{name:"SS "+((null===(t=e.displayName)||void 0===t?void 0:t.split(" ")[0])||"Voyager"),color:"text-blue-400",type:"scout",speed:1}};await (0,l.pl)(s,a),h(a)}}catch(t){console.error("Error fetching user data",t),"andrewpcarlson85@gmail.com"===e.email&&(console.log("Using Fallback Admin Profile due to DB error"),h({uid:e.uid,email:e.email,displayName:e.displayName,photoURL:e.photoURL,role:"teacher",status:"active",location:"earth",xp:9999,spaceship:{name:"SS Command (Fallback)",color:"text-yellow-400",type:"fighter",speed:2}}))}else h(null);p(!1)});return()=>e()},[]);let g=async()=>{try{await (0,n.rh)(i.I8,i.Vv)}catch(e){console.error("Login failed",e)}},f=async(e,t)=>{try{await (0,n.e5)(i.I8,e,t)}catch(e){throw console.error("Student Login Failed",e),e}},y=async()=>{await (0,n.w7)(i.I8),h(null),b.push("/")};return(0,a.jsx)(d.Provider,{value:{user:s,userData:u,loading:m,signInWithGoogle:g,signInStudent:f,logout:y},children:t})}let u=()=>(0,r.useContext)(d)},4499:function(e,t,s){"use strict";s.d(t,{I8:function(){return d},Vv:function(){return x},db:function(){return o},qe:function(){return i}});var a=s(6142),r=s(8121),n=s(7065),l=s(3493);let i={apiKey:"AIzaSyDVHiiCHkP-RFOI26cIrD_OijLnw1r3B8Q",authDomain:"spaceadventure-7d540.firebaseapp.com",projectId:"spaceadventure-7d540",storageBucket:"spaceadventure-7d540.firebasestorage.app",messagingSenderId:"546441300465",appId:"1:546441300465:web:28ae387d2bdbb8011a1c50",measurementId:"G-8R9PYL00XH"},c=(0,a.C6)().length>0?(0,a.Mq)():(0,a.ZF)(i),o=(0,r.ad)(c),d=(0,n.v0)(c),x=new n.hJ;(0,l.Gb)().then(e=>{e&&(0,l.IH)(c)})},1657:function(e,t,s){"use strict";s.d(t,{K:function(){return a},a:function(){return r}});let a=e=>{let t=e.startsWith("/")?e:"/".concat(e);return window.location.hostname.includes("github.io")?"https://shootyq.github.io/SpaceAdventure".concat(t):"".concat("").concat(t)},r=()=>{let e="ABCDEFGHJKLMNPQRSTUVWXYZ23456789",t="";for(let s=0;s<6;s++)t+=e.charAt(Math.floor(Math.random()*e.length));return t}}},function(e){e.O(0,[358,38,911,250,121,971,69,744],function(){return e(e.s=1910)}),_N_E=e.O()}]);