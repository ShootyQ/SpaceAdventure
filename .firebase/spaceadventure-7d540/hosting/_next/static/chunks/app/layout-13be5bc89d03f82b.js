(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{1332:function(e,t,a){Promise.resolve().then(a.bind(a,6678)),Promise.resolve().then(a.t.bind(a,3445,23)),Promise.resolve().then(a.t.bind(a,2445,23))},6678:function(e,t,a){"use strict";a.r(t),a.d(t,{AuthProvider:function(){return d},useAuth:function(){return h}});var r=a(3827),n=a(4090),o=a(7065),s=a(8121),i=a(4499),c=a(7907),l=a(1657);let u=(0,n.createContext)({});function d(e){let{children:t}=e,[a,d]=(0,n.useState)(null),[h,f]=(0,n.useState)(null),[m,p]=(0,n.useState)(!0),g=(0,c.useRouter)();(0,n.useEffect)(()=>{let e=(0,o.Aj)(i.I8,async e=>{if(d(e),e)try{let a=(0,s.JU)(i.db,"users",e.uid),r=await (0,s.QT)(a);if(r.exists()){let t=r.data(),n="andrewpcarlson85@gmail.com"===e.email,o={};if(n&&"teacher"!==t.role&&(console.log("Fixing Admin Role for Legacy User"),t.role="teacher",o.role="teacher"),"teacher"===t.role&&!t.classCode){console.log("Generating Class Code for existing teacher");let e=(0,l.a)();t.classCode=e,o.classCode=e}if(Object.keys(o).length>0)try{await (0,s.pl)(a,o,{merge:!0})}catch(e){console.warn("Could not update user profile in DB",e)}f(t)}else{var t;e.email;let r={uid:e.uid,email:e.email,displayName:e.displayName,photoURL:e.photoURL,role:"teacher",classCode:(0,l.a)(),status:"active",subscriptionStatus:"trial",schoolName:"",location:"earth",spaceship:{name:"SS "+((null===(t=e.displayName)||void 0===t?void 0:t.split(" ")[0])||"Voyager"),color:"text-blue-400",type:"scout",speed:1}};await (0,s.pl)(a,r),f(r)}}catch(t){console.error("Error fetching user data",t),"andrewpcarlson85@gmail.com"===e.email&&(console.log("Using Fallback Admin Profile due to DB error"),f({uid:e.uid,email:e.email,displayName:e.displayName,photoURL:e.photoURL,role:"teacher",status:"active",location:"earth",xp:9999,spaceship:{name:"SS Command (Fallback)",color:"text-yellow-400",type:"fighter",speed:2}}))}else f(null);p(!1)});return()=>e()},[]);let y=async()=>{try{await (0,o.rh)(i.I8,i.Vv)}catch(e){console.error("Login failed",e)}},b=async(e,t)=>{try{await (0,o.e5)(i.I8,e,t)}catch(e){throw console.error("Student Login Failed",e),e}},v=async()=>{await (0,o.w7)(i.I8),f(null),g.push("/")};return(0,r.jsx)(u.Provider,{value:{user:a,userData:h,loading:m,signInWithGoogle:y,signInStudent:b,logout:v},children:t})}let h=()=>(0,n.useContext)(u)},4499:function(e,t,a){"use strict";a.d(t,{I8:function(){return u},Vv:function(){return d},db:function(){return l},qe:function(){return i}});var r=a(6142),n=a(8121),o=a(7065),s=a(3493);let i={apiKey:"AIzaSyDVHiiCHkP-RFOI26cIrD_OijLnw1r3B8Q",authDomain:"spaceadventure-7d540.firebaseapp.com",projectId:"spaceadventure-7d540",storageBucket:"spaceadventure-7d540.firebasestorage.app",messagingSenderId:"546441300465",appId:"1:546441300465:web:28ae387d2bdbb8011a1c50",measurementId:"G-8R9PYL00XH"},c=(0,r.C6)().length>0?(0,r.Mq)():(0,r.ZF)(i),l=(0,n.ad)(c),u=(0,o.v0)(c),d=new o.hJ;(0,s.Gb)().then(e=>{e&&(0,s.IH)(c)})},1657:function(e,t,a){"use strict";a.d(t,{K:function(){return r},a:function(){return n}});let r=e=>{let t=e.startsWith("/")?e:"/".concat(e);return window.location.hostname.includes("github.io")?"https://shootyq.github.io/SpaceAdventure".concat(t):"".concat("").concat(t)},n=()=>{let e="ABCDEFGHJKLMNPQRSTUVWXYZ23456789",t="";for(let a=0;a<6;a++)t+=e.charAt(Math.floor(Math.random()*e.length));return t}},7907:function(e,t,a){"use strict";var r=a(5313);a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(t,{useSearchParams:function(){return r.useSearchParams}})},2445:function(){},3445:function(e){e.exports={style:{fontFamily:"'__Inter_f367f3', '__Inter_Fallback_f367f3'",fontStyle:"normal"},className:"__className_f367f3"}}},function(e){e.O(0,[358,38,911,971,69,744],function(){return e(e.s=1332)}),_N_E=e.O()}]);