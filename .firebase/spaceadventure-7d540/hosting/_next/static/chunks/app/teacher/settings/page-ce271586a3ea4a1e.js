(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[703],{1837:function(e,t,a){Promise.resolve().then(a.bind(a,916))},916:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return el}});var r=a(3827),s=a(4090),l=a(6678),i=a(8121),n=a(4499),d=a(1657),c=a(1828),o=a(1213),x=a(8943),u=a(5032),m=a(9259),g=a(5421),h=a(9496),p=a(1049),b=a(2882),v=a(7913),f=a(7404),j=a(3276),y=a(2220),w=a(7326),N=a(699),k=a(527),S=a(8727),C=a(4059),P=a(489),_=a(1524),z=a(3879),H=a(5423),Z=a(1165),E=a(5802),I=a(8745),A=a(8371);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let X=(0,a(7461).Z)("ShieldCheck",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);var L=a(94);let M=[{id:"1",name:"Space Cadet",minXP:0,image:"/images/badges/cadet.png"},{id:"2",name:"Rookie Pilot",minXP:100,image:"/images/badges/RookiePilot.png"},{id:"3",name:"Star Scout",minXP:300,image:"/images/badges/StarScout.png"},{id:"4",name:"Nebula Navigator",minXP:600,image:"/images/badges/NebulaNavigator.png"},{id:"5",name:"Solar Specialist",minXP:1e3,image:"/images/badges/SolarSpecialist.png"},{id:"6",name:"Comet Captain",minXP:1500,image:"/images/badges/CometCaptain.png"},{id:"7",name:"Galaxy Guardian",minXP:2200,image:"/images/badges/GalaxyGuardian.png"},{id:"8",name:"Cosmic Commander",minXP:3e3,image:"/images/badges/CosmicCommander.png"},{id:"9",name:"Void Admiral",minXP:4e3,image:"/images/badges/VoidAdmiral.png"},{id:"10",name:"Grand Star Admiral",minXP:5e3,image:"/images/badges/GrandStarAdmiral.png"}];function R(e){let{isOpen:t,onClose:a}=e,{user:d}=(0,l.useAuth)(),[c,o]=(0,s.useState)(M);(0,s.useEffect)(()=>{if(t&&d){let e=(0,i.JU)(n.db,"users/".concat(d.uid,"/settings"),"ranks"),t=(0,i.cf)(e,async e=>{if(e.exists()&&e.data().list)o(e.data().list);else{let e=(0,i.JU)(n.db,"game-config","ranks"),t=await (0,i.QT)(e);t.exists()&&t.data().list&&o(t.data().list)}});return()=>t()}},[t,d]);let x=async()=>{if(d)try{await (0,i.pl)((0,i.JU)(n.db,"users/".concat(d.uid,"/settings"),"ranks"),{list:c,teacherId:d.uid}),a()}catch(e){console.error("Error saving ranks:",e),alert("Failed to update protocols.")}};return(0,r.jsx)(I.M,{children:t&&(0,r.jsx)(A.E.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},exit:{opacity:0,y:50},className:"fixed inset-0 z-[100] bg-black/95 backdrop-blur-xl p-10 overflow-auto flex justify-center",children:(0,r.jsxs)("div",{className:"max-w-4xl w-full",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-8 pb-8 border-b border-white/10 sticky top-0 bg-black/95 z-10 pt-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h2",{className:"text-3xl font-bold text-white uppercase tracking-widest flex items-center gap-3",children:[(0,r.jsx)(X,{className:"text-cyan-400"})," Rank Protocols"]}),(0,r.jsx)("p",{className:"text-gray-400 mt-2",children:"Adjust experience thresholds and insignias."})]}),(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsxs)("button",{onClick:x,className:"bg-cyan-600 hover:bg-cyan-500 text-white font-bold py-2 px-6 rounded-lg uppercase tracking-wider flex items-center gap-2",children:[(0,r.jsx)(N.Z,{size:18})," Save Protocols"]}),(0,r.jsx)("button",{onClick:a,className:"bg-white/10 hover:bg-white/20 text-white font-bold py-2 px-6 rounded-lg uppercase tracking-wider",children:"Cancel"})]})]}),(0,r.jsx)("div",{className:"grid gap-4 pb-10",children:c.sort((e,t)=>e.minXP-t.minXP).map((e,t)=>{var a,s;return(0,r.jsxs)("div",{className:"bg-white/5 border border-white/10 rounded-xl p-4 flex items-center gap-6",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-black/50 rounded-lg flex items-center justify-center border border-white/5 overflow-hidden flex-shrink-0",children:e.image?(0,r.jsx)("img",{src:e.image,alt:"Rank",className:"w-12 h-12 object-contain"}):(0,r.jsx)("div",{className:"text-xs text-gray-500",children:"No Img"})}),(0,r.jsxs)("div",{className:"flex-1 grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-[10px] text-gray-500 uppercase font-bold tracking-wider mb-1 block",children:"Rank Title"}),(0,r.jsx)("input",{type:"text",value:e.name,onChange:t=>{let a=[...c],r=a.findIndex(t=>t.id===e.id);a[r]={...a[r],name:t.target.value},o(a)},className:"w-full bg-black/40 border border-white/10 rounded px-3 py-2 text-white/90 text-sm focus:border-cyan-500 focus:outline-none"}),M.find(t=>t.id===e.id)&&e.name!==(null===(a=M.find(t=>t.id===e.id))||void 0===a?void 0:a.name)&&(0,r.jsxs)("div",{className:"text-[10px] text-cyan-600/70 mt-1 italic cursor-pointer hover:text-cyan-400 decoration-dotted underline",onClick:()=>{let t=[...c],a=t.findIndex(t=>t.id===e.id),r=M.find(t=>t.id===e.id);r&&(t[a]={...t[a],name:r.name},o(t))},children:["(Reset to Default: ",null===(s=M.find(t=>t.id===e.id))||void 0===s?void 0:s.name,")"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-[10px] text-gray-500 uppercase font-bold tracking-wider mb-1 block",children:"Min XP Required"}),(0,r.jsx)("input",{type:"number",value:e.minXP,onChange:t=>{let a=[...c],r=a.findIndex(t=>t.id===e.id);a[r]={...a[r],minXP:parseInt(t.target.value)||0},o(a)},className:"w-full bg-black/40 border border-white/10 rounded px-3 py-2 text-white/90 text-sm focus:border-cyan-500 focus:outline-none font-mono"})]})]}),(0,r.jsx)("button",{onClick:()=>{o(t=>t.filter(t=>t.id!==e.id))},className:"p-2 text-red-400 hover:bg-red-500/20 rounded-lg transition-colors",children:(0,r.jsx)(P.Z,{size:20})})]},e.id||t)})}),(0,r.jsxs)("button",{onClick:()=>{o([...c,{id:Date.now().toString(),name:"New Rank",minXP:99999,image:"/images/badges/cadet.png"}])},className:"w-full py-4 mt-6 border border-dashed border-white/20 rounded-xl text-gray-400 hover:text-white hover:border-cyan-500/50 hover:bg-white/5 transition flex items-center justify-center gap-2 uppercase font-bold tracking-wider",children:[(0,r.jsx)(L.Z,{size:20})," Add New Rank Clearance"]})]})})})}var T=a(8792),F=a(7907);let U=e=>{var t;let{size:a=24,className:s=""}=e,{userData:i}=(0,l.useAuth)(),n=(null==i?void 0:null===(t=i.spaceship)||void 0===t?void 0:t.id)||"finalship";return(0,r.jsx)("img",{src:(0,d.K)("/images/ships/".concat(n,".png")),alt:"Rocket",className:"object-contain ".concat(s),style:{width:a,height:a}})},D=[{name:"Nebula Blue",class:"text-blue-400",bg:"bg-blue-400"},{name:"Mars Red",class:"text-red-400",bg:"bg-red-400"},{name:"Emerald",class:"text-green-400",bg:"bg-green-400"},{name:"Starlight Gold",class:"text-yellow-400",bg:"bg-yellow-400"},{name:"Void Purple",class:"text-purple-400",bg:"bg-purple-400"},{name:"Ice Cyan",class:"text-cyan-400",bg:"bg-cyan-400"}],O=e=>{let{icon:t,label:a,level:s=0,active:l=!1}=e;return(0,r.jsxs)("div",{className:"aspect-square rounded-xl flex flex-col items-center justify-center p-4 border transition-all cursor-pointer ".concat(l?"bg-cyan-500/20 border-cyan-400":"bg-black/40 border-cyan-900/40 hover:border-cyan-500/50 hover:bg-cyan-900/20"),children:[(0,r.jsx)(t,{size:24,className:"mb-2 ".concat(l?"text-cyan-300":"text-cyan-700")}),(0,r.jsx)("div",{className:"text-[10px] uppercase font-bold text-center tracking-wider ".concat(l?"text-cyan-100":"text-cyan-800"),children:a}),(0,r.jsx)("div",{className:"flex gap-1 mt-2",children:[void 0,void 0,void 0].map((e,t)=>(0,r.jsx)("div",{className:"w-1.5 h-1.5 rounded-full ".concat(t<s?"bg-cyan-400 shadow-[0_0_5px_currentColor]":"bg-cyan-950")},t))})]})},G=e=>{let{config:t}=e,a=e=>({red:"#ef4444",blue:"#3b82f6",green:"#22c55e",yellow:"#eab308",purple:"#a855f7",black:"#171717",white:"#f8fafc",orange:"#f97316"})[e]||"#3b82f6",s=a(t.primaryColor),l=a(t.secondaryColor),i="clip-".concat(t.primaryColor,"-").concat(t.secondaryColor,"-").concat(t.pattern,"-").concat(t.shape).replace(/[^a-z0-9]/gi,"");return(0,r.jsxs)("svg",{width:"24",height:"30",viewBox:"0 0 24 30",className:"drop-shadow-md",children:[(0,r.jsx)("rect",{x:"2",y:"2",width:"2",height:"28",rx:"1",fill:{silver:"#cbd5e1",gold:"#eab308",wood:"#854d0e",black:"#262626"}[t.pole]||"#cbd5e1"}),(0,r.jsxs)("g",{transform:"translate(4, 3)",children:[(0,r.jsx)("defs",{children:(0,r.jsxs)("clipPath",{id:i,children:["rectangle"===t.shape&&(0,r.jsx)("rect",{x:"0",y:"0",width:"20",height:"12"}),"pennant"===t.shape&&(0,r.jsx)("polygon",{points:"0,0 20,6 0,12"}),"triangle"===t.shape&&(0,r.jsx)("polygon",{points:"0,0 20,0 10,12 0,0"}),"swallowtail"===t.shape&&(0,r.jsx)("polygon",{points:"0,0 20,0 20,12 10,6 0,12"})]})}),(0,r.jsxs)("g",{clipPath:"url(#".concat(i,")"),children:["solid"===t.pattern&&(0,r.jsx)("rect",{x:"0",y:"0",width:"20",height:"12",fill:s}),"stripe-h"===t.pattern&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("rect",{x:"0",y:"0",width:"20",height:"12",fill:s}),(0,r.jsx)("rect",{x:"0",y:"6",width:"20",height:"6",fill:l})]}),"stripe-v"===t.pattern&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("rect",{x:"0",y:"0",width:"20",height:"12",fill:s}),(0,r.jsx)("rect",{x:"10",y:"0",width:"10",height:"12",fill:l})]}),"cross"===t.pattern&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("rect",{x:"0",y:"0",width:"20",height:"12",fill:s}),(0,r.jsx)("rect",{x:"8",y:"0",width:"4",height:"12",fill:l}),(0,r.jsx)("rect",{x:"0",y:"4",width:"20",height:"4",fill:l})]}),"circle"===t.pattern&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("rect",{x:"0",y:"0",width:"20",height:"12",fill:s}),(0,r.jsx)("circle",{cx:"10",cy:"6",r:"4",fill:l})]}),"checkered"===t.pattern&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("rect",{x:"0",y:"0",width:"10",height:"6",fill:s}),(0,r.jsx)("rect",{x:"10",y:"0",width:"10",height:"6",fill:l}),(0,r.jsx)("rect",{x:"0",y:"6",width:"10",height:"6",fill:l}),(0,r.jsx)("rect",{x:"10",y:"6",width:"10",height:"6",fill:s})]})]})]})]})};function B(e){var t,a,d,b,v,f;let{onNavigate:j,ranks:y,onOpenRankEditor:w}=e,{userData:N,logout:k}=(0,l.useAuth)(),[S,C]=(0,s.useState)((null==N?void 0:N.schoolName)||""),[P,_]=(0,s.useState)(!1),z=async()=>{if(null==N?void 0:N.uid)try{await (0,i.r7)((0,i.JU)(n.db,"users",N.uid),{schoolName:S}),_(!1)}catch(e){console.error("Error saving class name:",e)}},H=[{id:"ship",title:"Hangar Bay",icon:U,color:"text-cyan-400",border:"border-cyan-500",bg:"bg-cyan-950/30"},{id:"inventory",title:"Cargo Hold",icon:c.Z,color:"text-amber-400",border:"border-amber-500",bg:"bg-amber-950/30"},{id:"avatar",title:"Pilot Profile",icon:o.Z,color:"text-purple-400",border:"border-purple-500",bg:"bg-purple-950/30"},{id:"flag",title:"Flag Designer",icon:x.Z,color:"text-red-400",border:"border-red-500",bg:"bg-red-950/30"}],Z=(null==N?void 0:N.xp)||0,I=[...y].sort((e,t)=>e.minXP-t.minXP),X=I.slice().reverse().find(e=>Z>=e.minXP)||I[0]||{name:"Recruit",minXP:0},L=I.find(e=>e.minXP>Z),M=L?(Z-X.minXP)/(L.minXP-X.minXP)*100:100;null==N||null===(t=N.avatar)||void 0===t||t.hue,null==N||null===(a=N.avatar)||void 0===a||a.skinHue,(null==N?void 0:null===(d=N.avatar)||void 0===d?void 0:d.bgHue)!==void 0&&N.avatar.bgHue,(null==N?void 0:null===(b=N.avatar)||void 0===b?void 0:b.bgSat)!==void 0&&N.avatar.bgSat,(null==N?void 0:null===(v=N.avatar)||void 0===v?void 0:v.bgLight)!==void 0&&N.avatar.bgLight;let R=(null==N?void 0:null===(f=N.spaceship)||void 0===f?void 0:f.color)||"text-cyan-400";return R.includes("-")&&R.split("-")[1],(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 max-w-6xl mx-auto mt-8",children:[(0,r.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,r.jsxs)("h2",{className:"text-xl text-cyan-500 uppercase tracking-[0.2em] font-bold border-b border-cyan-500/30 pb-2 mb-6 flex items-center gap-3",children:[(0,r.jsx)(u.Z,{size:20})," Navigation Systems"]}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:H.map((e,t)=>(0,r.jsxs)(A.E.button,{onClick:()=>j(e.id),initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1*t},whileHover:{scale:1.02},whileTap:{scale:.98},className:"\n                                ".concat(e.bg," ").concat(e.border," border rounded-2xl p-6\n                                flex items-center gap-6 text-left\n                                backdrop-blur-sm group relative overflow-hidden transition-all duration-300\n                                hover:bg-black/60\n                            "),children:[(0,r.jsx)("div",{className:"p-4 rounded-xl bg-black/50 border ".concat(e.border," ").concat(e.color," shadow-[0_0_15px_rgba(0,0,0,0.5)] group-hover:scale-110 transition-transform duration-300 overflow-hidden relative flex items-center justify-center"),children:"avatar"===e.id?(0,r.jsx)(E.Yt,{userData:N,className:"w-8 h-8 rounded-full border border-white/20"}):"flag"===e.id&&(null==N?void 0:N.flag)?(0,r.jsx)("div",{className:"scale-125",children:(0,r.jsx)(G,{config:N.flag})}):(0,r.jsx)(e.icon,{size:32})}),(0,r.jsxs)("div",{className:"z-10",children:[(0,r.jsx)("h3",{className:"text-xl font-bold uppercase tracking-wider ".concat(e.color," drop-shadow-md"),children:e.title}),(0,r.jsx)("p",{className:"text-gray-400 text-xs mt-1 uppercase tracking-widest opacity-70 group-hover:opacity-100 transition-opacity",children:"Access System"})]}),(0,r.jsx)("div",{className:"absolute top-0 right-0 w-8 h-8 ".concat(e.color.replace("text","bg").replace("400","500"),"/10 rounded-bl-3xl")})]},e.id))})]}),(0,r.jsxs)("div",{className:"bg-black/40 border-l border-white/10 p-6 flex flex-col gap-8 rounded-r-3xl relative backdrop-blur-sm lg:min-h-[500px]",children:[(0,r.jsxs)("div",{className:"border-b border-white/10 pb-4 text-center pb-6",children:[(0,r.jsx)("h2",{className:"text-white/70 uppercase tracking-[0.3em] text-xs font-bold mb-1",children:"Active Personnel"}),(0,r.jsx)("div",{className:"text-2xl font-bold text-white tracking-widest truncate mb-2",children:(null==N?void 0:N.displayName)||"Unknown Commander"}),(0,r.jsx)("div",{className:"flex justify-center items-center gap-2 mb-3",children:P?(0,r.jsxs)("div",{className:"flex items-center gap-2 bg-white/5 rounded-lg p-1",children:[(0,r.jsx)("input",{value:S,onChange:e=>C(e.target.value),className:"bg-transparent border-none text-cyan-400 text-sm font-bold uppercase tracking-wider w-32 text-center focus:outline-none",placeholder:"CLASS NAME"}),(0,r.jsx)("button",{onClick:z,className:"p-1 hover:bg-green-500/20 text-green-400 rounded",children:(0,r.jsx)(m.Z,{size:14})})]}):(0,r.jsxs)("div",{className:"flex items-center gap-2 text-cyan-400 hover:text-cyan-300 transition-colors cursor-pointer group",onClick:()=>_(!0),children:[(0,r.jsx)("span",{className:"text-sm font-bold uppercase tracking-widest",children:(null==N?void 0:N.schoolName)||"Set Class Name"}),(0,r.jsx)(g.Z,{size:12,className:"opacity-0 group-hover:opacity-100 transition-opacity"})]})}),(0,r.jsxs)("div",{className:"flex justify-center gap-4 text-[10px] uppercase font-bold tracking-widest text-cyan-400/80",children:[(0,r.jsx)("span",{children:X.name}),(0,r.jsx)("span",{className:"text-white/30"}),(0,r.jsxs)("span",{children:[Z," XP"]})]})]}),(0,r.jsxs)("div",{className:"relative h-48 flex items-center justify-center",children:[(0,r.jsx)("div",{className:"absolute left-0 w-24 h-24 rounded-full border-2 border-purple-500/50 overflow-hidden bg-black shadow-[0_0_20px_rgba(168,85,247,0.3)] z-20",children:(0,r.jsx)(E.Yt,{userData:N,className:"w-full h-full"})}),(0,r.jsx)("div",{className:"absolute h-px bg-gradient-to-r from-purple-500/50 to-cyan-500/50 w-full top-1/2 -z-0"}),(0,r.jsx)("div",{className:"absolute right-0 w-24 h-24 rounded-full border-2 border-cyan-500/50 overflow-hidden bg-black flex items-center justify-center shadow-[0_0_20px_rgba(6,182,212,0.3)] z-20",children:(0,r.jsx)(A.E.div,{animate:{rotate:[0,5,-5,0]},transition:{duration:6,repeat:1/0},children:(0,r.jsx)(U,{size:56,className:"drop-shadow-[0_0_10px_rgba(255,255,255,0.5)]"})})})]}),(0,r.jsxs)("div",{className:"flex-1 bg-white/5 rounded-xl p-6 border border-white/5 relative overflow-hidden",children:[(0,r.jsxs)("div",{className:"relative z-10",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-xs text-yellow-500 uppercase tracking-widest font-bold mb-1",children:"Current Designaton"}),(0,r.jsx)("div",{className:"text-xl font-bold text-white uppercase tracking-wider",children:X.name})]}),X.image&&(0,r.jsx)("img",{src:X.image,alt:"Rank Badge",className:"w-16 h-16 object-contain drop-shadow-[0_0_15px_rgba(250,204,21,0.3)]"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between text-xs font-mono text-gray-400",children:[(0,r.jsxs)("span",{children:[Z," XP"]}),(0,r.jsxs)("span",{children:[L?L.minXP:"MAX"," XP"]})]}),(0,r.jsx)("div",{className:"h-2 bg-black/50 rounded-full overflow-hidden border border-white/10",children:(0,r.jsx)(A.E.div,{initial:{width:0},animate:{width:"".concat(M,"%")},className:"h-full bg-gradient-to-r from-yellow-600 to-yellow-400"})}),(0,r.jsx)("p",{className:"text-[10px] text-center text-gray-500 uppercase tracking-widest mt-2",children:L?"To Next Promotion":"Maximum Rank Achieved"})]})]}),(0,r.jsxs)("div",{className:"mt-6 aspect-square w-full flex flex-col items-center justify-center relative overflow-hidden rounded-lg bg-black/20 border border-white/5",children:[X.image?(0,r.jsx)("div",{className:"relative z-10 w-full h-full p-6 pb-8",children:(0,r.jsx)("img",{src:X.image,alt:"Badge",className:"w-full h-full object-contain drop-shadow-[0_0_20px_rgba(255,255,255,0.2)]"})}):(0,r.jsx)("div",{className:"w-12 h-12 rounded-full bg-black/30 flex items-center justify-center text-white/20",children:(0,r.jsx)(h.Z,{size:24})}),(0,r.jsx)("span",{className:"absolute bottom-2 text-[10px] text-yellow-500/50 uppercase tracking-widest font-bold z-10",children:"Current Designation"})]})]}),(0,r.jsxs)("button",{onClick:k,className:"flex items-center justify-center gap-2 p-3 rounded-xl border border-red-500/20 bg-red-500/10 text-red-400 hover:bg-red-500/20 hover:border-red-500/40 hover:text-red-300 transition-all uppercase tracking-widest text-xs font-bold",children:[(0,r.jsx)(p.Z,{size:16}),"System Logout"]})]})]})}let K=[{id:"finalship",name:"Standard Interceptor"},{id:"alienship",name:"Alien Scout"},{id:"jellyalienship",name:"Bio-Cruiser"},{id:"coconutship",name:"Tropical Drifter"},{id:"dragoneggship",name:"Dragon Scale Pod"}];function V(e){var t,a,l,c,o,x,u,m,g;let{userData:h,user:p}=e,[k,S]=(0,s.useState)(!1),[C,P]=(0,s.useState)(""),[_,z]=(0,s.useState)(D[0]),[H,Z]=(0,s.useState)("finalship");(0,s.useEffect)(()=>{(null==h?void 0:h.spaceship)&&(P(h.spaceship.name),z(D.find(e=>{var t;return e.class===(null===(t=h.spaceship)||void 0===t?void 0:t.color)})||D[0]),Z(h.spaceship.id||"finalship"))},[h]);let E=async()=>{if(p){S(!0);try{let e=(0,i.JU)(n.db,"users",p.uid);await (0,i.r7)(e,{"spaceship.name":C,"spaceship.color":_.class,"spaceship.id":H}),alert("Ship specifications updated, Commander.")}catch(e){console.error(e),alert("Error updating ship specs.")}S(!1)}},I=500+250*((null==h?void 0:null===(t=h.upgrades)||void 0===t?void 0:t.fuel)||0),X=(null==h?void 0:h.fuel)!==void 0?h.fuel:500,L=Math.min(X/I*100,100);return(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 max-w-6xl mx-auto",children:[(0,r.jsxs)("div",{className:"bg-black/50 border border-cyan-900/50 rounded-2xl p-8 flex flex-col items-center justify-center relative min-h-[500px]",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-cyan-900/20 to-transparent pointer-events-none"}),(0,r.jsx)(A.E.div,{className:"relative z-10 ".concat(_.class),animate:{y:[-15,15,-15],rotate:[0,1,-1,0]},transition:{duration:6,repeat:1/0,ease:"easeInOut"},children:(0,r.jsx)("img",{src:(0,d.K)("/images/ships/".concat(H,".png")),alt:"Ship",className:"w-[280px] h-[280px] object-contain drop-shadow-[0_0_25px_currentColor]"})}),(0,r.jsxs)("div",{className:"mt-12 text-center z-10 w-full max-w-md",children:[(0,r.jsx)("h2",{className:"text-3xl font-bold text-white tracking-widest uppercase mb-6",children:C||"Unknown Vessel"}),(0,r.jsxs)("div",{className:"bg-black/60 border border-cyan-900/50 rounded-xl p-4 w-full",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center text-xs uppercase font-bold tracking-widest mb-2",children:[(0,r.jsx)("span",{className:"text-cyan-500",children:"Hyperfuel Reserves"}),(0,r.jsxs)("span",{className:"text-white",children:[Math.floor(X)," / ",I," Units"]})]}),(0,r.jsxs)("div",{className:"relative h-4 bg-cyan-950/50 rounded-full overflow-hidden border border-cyan-900",children:[(0,r.jsx)("div",{className:"absolute top-0 left-0 h-full bg-gradient-to-r from-cyan-600 to-cyan-400 transition-all duration-1000 ease-out",style:{width:"".concat(L,"%")}}),(0,r.jsxs)("div",{className:"absolute inset-0 flex justify-between px-2",children:[(0,r.jsx)("div",{className:"w-px h-full bg-black/20"}),(0,r.jsx)("div",{className:"w-px h-full bg-black/20"}),(0,r.jsx)("div",{className:"w-px h-full bg-black/20"}),(0,r.jsx)("div",{className:"w-px h-full bg-black/20"})]})]}),(0,r.jsx)("div",{className:"text-[10px] text-cyan-700/60 mt-1 font-mono text-center",children:"FUEL CELLS ONLINE  POWERED BY XP"})]})]}),(0,r.jsxs)("div",{className:"absolute top-4 left-4 text-xs text-cyan-800 font-mono",children:["HULL INTEGRITY: 100%",(0,r.jsx)("br",{}),"SHIELDS: ONLINE"]})]}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"bg-cyan-950/20 p-6 rounded-xl border border-cyan-500/20",children:[(0,r.jsx)("label",{className:"block text-sm uppercase tracking-wider text-cyan-500 mb-2",children:"Vessel Identification"}),(0,r.jsx)("input",{type:"text",value:C,onChange:e=>P(e.target.value),className:"w-full bg-black/50 border border-cyan-700 rounded p-3 text-white focus:outline-none focus:border-cyan-400 placeholder-cyan-800 transition-colors font-mono",placeholder:"Enter Ship Name"})]}),(0,r.jsxs)("div",{className:"bg-cyan-950/20 p-6 rounded-xl border border-cyan-500/20",children:[(0,r.jsxs)("label",{className:"block text-sm uppercase tracking-wider text-cyan-500 mb-4 flex items-center gap-2",children:[(0,r.jsx)(U,{size:16})," Chassis Selector"]}),(0,r.jsx)("div",{className:"grid grid-cols-3 gap-3",children:K.map(e=>(0,r.jsxs)("button",{onClick:()=>Z(e.id),className:"p-2 rounded border flex flex-col items-center gap-2 transition-all ".concat(H===e.id?"bg-cyan-500/20 border-cyan-400":"bg-black/40 border-cyan-900 hover:border-cyan-700"),children:[(0,r.jsx)("img",{src:(0,d.K)("/images/ships/".concat(e.id,".png")),alt:e.name,className:"w-12 h-12 object-contain"}),(0,r.jsx)("span",{className:"text-[10px] uppercase font-bold text-center ".concat(H===e.id?"text-white":"text-gray-500"),children:e.name})]},e.id))})]}),(0,r.jsxs)("div",{className:"bg-cyan-950/20 p-6 rounded-xl border border-cyan-500/20",children:[(0,r.jsxs)("label",{className:"block text-sm uppercase tracking-wider text-cyan-500 mb-4 flex items-center gap-2",children:[(0,r.jsx)(b.Z,{size:16})," Hull Nanocoating"]}),(0,r.jsx)("div",{className:"grid grid-cols-3 gap-3",children:D.map(e=>(0,r.jsxs)("button",{onClick:()=>z(e),className:"p-3 rounded border flex items-center gap-3 transition-all ".concat(_.name===e.name?"bg-cyan-500/20 border-cyan-400 scale-105":"bg-black/40 border-cyan-900 hover:border-cyan-700"),children:[(0,r.jsx)("div",{className:"w-4 h-4 rounded-full ".concat(e.bg," shadow-[0_0_5px_currentColor]")}),(0,r.jsx)("span",{className:"text-xs uppercase font-bold ".concat(_.name===e.name?"text-white":"text-gray-500"),children:e.name})]},e.name))})]}),(0,r.jsxs)("div",{className:"bg-cyan-950/20 p-6 rounded-xl border border-cyan-500/20",children:[(0,r.jsxs)("label",{className:"block text-sm uppercase tracking-wider text-cyan-500 mb-4 flex items-center gap-2",children:[(0,r.jsx)(v.Z,{size:16})," System Upgrades"]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsx)(O,{icon:f.Z,label:"Boosters",level:(null==h?void 0:null===(a=h.upgrades)||void 0===a?void 0:a.boosters)||0,active:((null==h?void 0:null===(l=h.upgrades)||void 0===l?void 0:l.boosters)||0)>0}),(0,r.jsx)(O,{icon:j.Z,label:"Fuel Tank",level:(null==h?void 0:null===(c=h.upgrades)||void 0===c?void 0:c.fuel)||0,active:((null==h?void 0:null===(o=h.upgrades)||void 0===o?void 0:o.fuel)||0)>0}),(0,r.jsx)(O,{icon:y.Z,label:"Landers",level:(null==h?void 0:null===(x=h.upgrades)||void 0===x?void 0:x.landers)||0,active:((null==h?void 0:null===(u=h.upgrades)||void 0===u?void 0:u.landers)||0)>0}),(0,r.jsx)(O,{icon:w.Z,label:"Hull Plating",level:(null==h?void 0:null===(m=h.upgrades)||void 0===m?void 0:m.hull)||0,active:((null==h?void 0:null===(g=h.upgrades)||void 0===g?void 0:g.hull)||0)>0})]})]}),(0,r.jsxs)("button",{onClick:E,disabled:k,className:"w-full py-4 rounded-xl flex items-center justify-center gap-3 font-bold uppercase tracking-widest transition-all ".concat(k?"bg-gray-700 text-gray-400 cursor-wait":"bg-cyan-600 hover:bg-cyan-500 text-black hover:scale-[1.02] shadow-[0_0_20px_rgba(8,145,178,0.4)]"),children:[(0,r.jsx)(N.Z,{size:20}),k?"Calibrating...":"Save Configuration"]})]})]})}function J(){return(0,r.jsxs)("div",{className:"max-w-4xl mx-auto border border-amber-500/30 bg-black/40 rounded-3xl p-8 min-h-[500px]",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-8 pb-4 border-b border-amber-500/30",children:[(0,r.jsx)(j.Z,{className:"text-amber-400",size:32}),(0,r.jsx)("h2",{className:"text-2xl font-bold text-amber-400 uppercase tracking-widest",children:"Cargo Hold"})]}),(0,r.jsx)("div",{className:"grid grid-cols-4 md:grid-cols-6 gap-4",children:[...Array(24)].map((e,t)=>(0,r.jsx)("div",{className:"aspect-square bg-amber-950/20 border border-amber-900/50 rounded-lg flex items-center justify-center hover:bg-amber-900/30 hover:border-amber-500/50 transition-colors cursor-pointer group",children:(0,r.jsx)("div",{className:"text-amber-900/40 text-xs font-mono group-hover:text-amber-500/60",children:"EMPTY"})},t))}),(0,r.jsx)("div",{className:"mt-8 text-center text-amber-500/50 font-mono text-sm",children:"0 / 24 SLOTS OCCUPIED"})]})}function Y(e){var t,a,d,c,o,x,u,m;let{onBack:g}=e,{user:h,userData:p}=(0,l.useAuth)(),[v,f]=(0,s.useState)(!1),[j,y]=(0,s.useState)((null==p?void 0:null===(t=p.avatar)||void 0===t?void 0:t.hue)||0),[w,N]=(0,s.useState)((null==p?void 0:null===(a=p.avatar)||void 0===a?void 0:a.skinHue)||0),[k,S]=(0,s.useState)((null==p?void 0:null===(d=p.avatar)||void 0===d?void 0:d.bgHue)!==void 0?p.avatar.bgHue:240),[C,P]=(0,s.useState)((null==p?void 0:null===(c=p.avatar)||void 0===c?void 0:c.bgSat)!==void 0?p.avatar.bgSat:50),[_,z]=(0,s.useState)((null==p?void 0:null===(o=p.avatar)||void 0===o?void 0:o.bgLight)!==void 0?p.avatar.bgLight:20),[H,Z]=(0,s.useState)((null==p?void 0:null===(x=p.avatar)||void 0===x?void 0:x.activeHat)||"none"),[I,A]=(0,s.useState)((null==p?void 0:null===(u=p.avatar)||void 0===u?void 0:u.avatarId)||"bunny"),X=e=>{A(e),y(0),N(0)},L=async()=>{if(h){f(!0);try{let e=(0,i.JU)(n.db,"users",h.uid);await (0,i.r7)(e,{"avatar.hue":j,"avatar.skinHue":w,"avatar.bgHue":k,"avatar.bgSat":C,"avatar.bgLight":_,"avatar.activeHat":H,"avatar.avatarId":I}),g()}catch(e){console.error(e),alert("Error saving DNA sequence.")}f(!1)}};return(0,r.jsxs)("div",{className:"max-w-6xl mx-auto grid grid-cols-1 md:grid-cols-2 gap-8",children:[(0,r.jsxs)("div",{className:"border border-purple-500/30 bg-black/40 rounded-3xl p-8 flex flex-col items-center justify-center min-h-[400px] relative",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-purple-900/20 to-transparent pointer-events-none"}),(0,r.jsx)("div",{className:"relative w-64 h-64 rounded-full border-4 border-purple-500/50 overflow-visible flex items-center justify-center transition-colors duration-300 ring-4 ring-purple-900/30 shadow-[0_0_50px_rgba(168,85,247,0.4)]",children:(0,r.jsx)(E.Yt,{hue:j,skinHue:w,bgHue:k,bgSat:C,bgLight:_,hat:H,avatarId:I,className:"w-full h-full rounded-full"})}),(0,r.jsxs)("div",{className:"mt-8 text-center",children:[(0,r.jsx)("h3",{className:"text-xl font-bold text-purple-400 uppercase tracking-widest mb-1",children:"Preview"}),(0,r.jsx)("p",{className:"text-purple-300/60 text-sm font-mono",children:"none"!==H?null===(m=E.Cn.find(e=>e.id===H))||void 0===m?void 0:m.name:"Standard Uniform"})]})]}),(0,r.jsxs)("div",{className:"space-y-6 max-h-[700px] overflow-y-auto custom-scrollbar pr-2",children:[(0,r.jsxs)("div",{className:"bg-purple-950/20 p-6 rounded-xl border border-purple-500/20",children:[(0,r.jsxs)("h3",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[(0,r.jsx)(b.Z,{size:20,className:"text-purple-400"}),(0,r.jsx)("span",{className:"uppercase tracking-wider",children:"Select Identity"})]}),(0,r.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:E.W$.map(e=>(0,r.jsxs)("button",{onClick:()=>X(e.id),className:"group relative p-4 rounded-xl border transition-all flex flex-col items-center gap-3 ".concat(I===e.id?"bg-purple-900/40 border-purple-400":"border-white/10 bg-black/40 hover:bg-purple-900/20 hover:border-purple-500/50"),children:[(0,r.jsx)("div",{className:"w-16 h-16 rounded-full border-2 border-white/20 overflow-hidden relative group-hover:scale-110 transition-transform",children:(0,r.jsx)(E.Yt,{hue:0,skinHue:0,bgHue:240,bgSat:50,bgLight:20,hat:H,avatarId:e.id,className:"w-full h-full"})}),(0,r.jsx)("span",{className:"text-xs font-bold uppercase tracking-wider ".concat(I===e.id?"text-white":"text-purple-300 group-hover:text-white"),children:e.name})]},e.id))})]}),(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsx)("button",{onClick:g,disabled:v,className:"flex-1 py-4 rounded-xl border border-purple-500/30 text-purple-400 hover:bg-purple-500/10 uppercase tracking-widest font-bold transition-all",children:"Cancel"}),(0,r.jsx)("button",{onClick:L,disabled:v,className:"flex-1 py-4 rounded-xl bg-purple-600 hover:bg-purple-500 text-black uppercase tracking-widest font-bold transition-all shadow-[0_0_20px_rgba(147,51,234,0.4)]",children:v?"Saving...":"Confirm Identity"})]})]})]})}function q(e){var t,a,d,c,o;let{onNavigate:x,ranks:u}=e,{userData:m,user:g}=(0,l.useAuth)(),[h,p]=(0,s.useState)(!1),[b,f]=(0,s.useState)("");null==m||null===(t=m.avatar)||void 0===t||t.hue,null==m||null===(a=m.avatar)||void 0===a||a.skinHue,(null==m?void 0:null===(d=m.avatar)||void 0===d?void 0:d.bgHue)!==void 0&&m.avatar.bgHue,(null==m?void 0:null===(c=m.avatar)||void 0===c?void 0:c.bgSat)!==void 0&&m.avatar.bgSat,(null==m?void 0:null===(o=m.avatar)||void 0===o?void 0:o.bgLight)!==void 0&&m.avatar.bgLight;let j=(null==m?void 0:m.xp)||0,y=[...u||[]].sort((e,t)=>e.minXP-t.minXP).slice().reverse().find(e=>j>=e.minXP)||{name:"Recruit",minXP:0};(0,s.useEffect)(()=>{(null==m?void 0:m.displayName)&&f(m.displayName)},[m]);let w=async()=>{if(g&&b.trim())try{let e=(0,i.JU)(n.db,"users",g.uid);await (0,i.r7)(e,{displayName:b}),p(!1)}catch(e){console.error(e),alert("Failed to update identification.")}};return(0,r.jsxs)("div",{className:"max-w-4xl mx-auto border border-purple-500/30 bg-black/40 rounded-3xl p-8 min-h-[500px] flex flex-col items-center justify-center",children:[(0,r.jsxs)("div",{className:"relative mb-8 group",children:[(0,r.jsxs)("div",{className:"w-48 h-48 rounded-full border-4 border-purple-500/50 overflow-hidden flex items-center justify-center relative transition-colors duration-300",children:[(0,r.jsx)(E.Yt,{userData:m,className:"w-full h-full"}),(0,r.jsx)("div",{className:"absolute inset-0 bg-purple-500/10 mix-blend-overlay opacity-0 group-hover:opacity-100 transition-opacity z-20 pointer-events-none"})]}),(0,r.jsx)("button",{onClick:()=>x("avatar-config"),className:"absolute bottom-0 right-0 p-3 bg-purple-500 rounded-full text-black hover:bg-purple-400 transition-colors shadow-[0_0_15px_rgba(168,85,247,0.5)] z-30",children:(0,r.jsx)(v.Z,{size:20})})]}),(0,r.jsx)("div",{className:"flex items-center gap-3 mb-2 relative",children:h?(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("input",{type:"text",value:b,onChange:e=>f(e.target.value),className:"bg-black/50 border border-purple-500 text-white font-bold text-2xl px-2 py-1 rounded w-64 text-center focus:outline-none focus:ring-2 focus:ring-purple-500",autoFocus:!0}),(0,r.jsx)("button",{onClick:w,className:"p-2 bg-green-600 rounded-lg hover:bg-green-500 text-white",children:(0,r.jsx)(N.Z,{size:16})}),(0,r.jsx)("button",{onClick:()=>p(!1),className:"p-2 bg-red-600 rounded-lg hover:bg-red-500 text-white"})]}):(0,r.jsxs)("div",{className:"flex items-center gap-3 group/edit",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-white cursor-pointer",onClick:()=>p(!0),children:(null==m?void 0:m.displayName)||"Cadet Pilot"}),(0,r.jsx)("button",{onClick:()=>p(!0),className:"text-purple-500 opacity-0 group-hover/edit:opacity-100 transition-opacity p-1 hover:bg-purple-500/20 rounded",children:(0,r.jsx)(v.Z,{size:14})})]})}),(0,r.jsxs)("p",{className:"text-purple-400 font-mono text-sm tracking-wider mb-8 uppercase",children:[y.name,"  NO FACTION"]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4 w-full max-w-md",children:[(0,r.jsxs)("div",{className:"bg-purple-950/30 p-4 rounded-xl border border-purple-500/20 text-center",children:[(0,r.jsxs)("div",{className:"text-2xl font-bold text-white",children:[j," XP"]}),(0,r.jsx)("div",{className:"text-xs text-purple-400 uppercase tracking-wider",children:"Experience"})]}),(0,r.jsxs)("div",{className:"bg-purple-950/30 p-4 rounded-xl border border-purple-500/20 text-center",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-white",children:j}),(0,r.jsx)("div",{className:"text-xs text-purple-400 uppercase tracking-wider",children:"Current XP"})]})]})]})}let W=[{id:"silver",name:"Titanium",color:"#cbd5e1"},{id:"gold",name:"Gold Ultima",color:"#eab308"},{id:"wood",name:"Ancient Oak",color:"#854d0e"},{id:"black",name:"Carbon Fiber",color:"#262626"}],Q=[{id:"solid",name:"Solid Standard"},{id:"stripe-h",name:"Horizon Stripe"},{id:"stripe-v",name:"Vertical Split"},{id:"cross",name:"Solar Cross"},{id:"checkered",name:"Battle Checker"},{id:"circle",name:"Core Sun"}],$=[{id:"red",hex:"#ef4444"},{id:"blue",hex:"#3b82f6"},{id:"green",hex:"#22c55e"},{id:"yellow",hex:"#eab308"},{id:"purple",hex:"#a855f7"},{id:"black",hex:"#171717"},{id:"white",hex:"#f8fafc"},{id:"orange",hex:"#f97316"}];function ee(){var e,t;let{userData:a,user:d}=(0,l.useAuth)(),[c,o]=(0,s.useState)(!1),[u,m]=(0,s.useState)("silver"),[g,h]=(0,s.useState)("solid"),[p,b]=(0,s.useState)("blue"),[v,f]=(0,s.useState)("white"),[j,y]=(0,s.useState)("rectangle");(0,s.useEffect)(()=>{(null==a?void 0:a.flag)&&(m(a.flag.pole||"silver"),h(a.flag.pattern||"solid"),b(a.flag.primaryColor||"blue"),f(a.flag.secondaryColor||"white"),y(a.flag.shape||"rectangle"))},[a]);let w=async()=>{if(d){o(!0);try{await (0,i.r7)((0,i.JU)(n.db,"users",d.uid),{flag:{pole:u,pattern:g,primaryColor:p,secondaryColor:v,shape:j}}),alert("Flag constructed successfully!")}catch(e){console.error(e),alert("Error saving flag.")}o(!1)}},k=e=>{var t;return(null===(t=$.find(t=>t.id===e))||void 0===t?void 0:t.hex)||"#3b82f6"};return(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 max-w-6xl mx-auto",children:[(0,r.jsxs)("div",{className:"bg-black/50 border border-red-900/50 rounded-2xl p-8 flex flex-col items-center justify-center min-h-[400px] relative",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-red-900/20 to-transparent pointer-events-none"}),(0,r.jsx)("div",{className:"relative z-10 scale-150",children:(0,r.jsxs)("svg",{width:"220",height:"300",viewBox:"0 0 220 300",children:[(0,r.jsx)("rect",{x:"10",y:"20",width:"10",height:"280",rx:"5",fill:null===(e=W.find(e=>e.id===u))||void 0===e?void 0:e.color}),(0,r.jsxs)("g",{transform:"translate(20, 30)",children:[(0,r.jsx)("defs",{children:(0,r.jsxs)("clipPath",{id:"flagShape",children:["rectangle"===j&&(0,r.jsx)("rect",{x:"0",y:"0",width:"200",height:"120"}),"pennant"===j&&(0,r.jsx)("polygon",{points:"0,0 200,60 0,120"}),"triangle"===j&&(0,r.jsx)("polygon",{points:"0,0 200,0 100,120 0,0"}),"swallowtail"===j&&(0,r.jsx)("polygon",{points:"0,0 200,0 200,120 100,60 0,120"})]})}),(0,r.jsxs)("g",{clipPath:"url(#flagShape)",children:[(()=>{let e=k(p),t=k(v);switch(g){case"solid":default:return(0,r.jsx)("rect",{x:"0",y:"0",width:"200",height:"120",fill:e});case"stripe-h":return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("rect",{x:"0",y:"0",width:"200",height:"120",fill:e}),(0,r.jsx)("rect",{x:"0",y:"40",width:"200",height:"40",fill:t})]});case"stripe-v":return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("rect",{x:"0",y:"0",width:"200",height:"120",fill:e}),(0,r.jsx)("rect",{x:"66",y:"0",width:"66",height:"120",fill:t})]});case"cross":return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("rect",{x:"0",y:"0",width:"200",height:"120",fill:e}),(0,r.jsx)("rect",{x:"50",y:"0",width:"30",height:"120",fill:t}),(0,r.jsx)("rect",{x:"0",y:"45",width:"200",height:"30",fill:t})]});case"circle":return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("rect",{x:"0",y:"0",width:"200",height:"120",fill:e}),(0,r.jsx)("circle",{cx:"100",cy:"60",r:"35",fill:t})]});case"checkered":return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("rect",{x:"0",y:"0",width:"100",height:"60",fill:e}),(0,r.jsx)("rect",{x:"100",y:"0",width:"100",height:"60",fill:t}),(0,r.jsx)("rect",{x:"0",y:"60",width:"100",height:"60",fill:t}),(0,r.jsx)("rect",{x:"100",y:"60",width:"100",height:"60",fill:e})]})}})(),(0,r.jsx)("rect",{x:"0",y:"0",width:"200",height:"120",fill:"url(#ripple)",opacity:"0.3",style:{mixBlendMode:"multiply"}})]})]}),(0,r.jsx)("circle",{cx:"15",cy:"20",r:"8",fill:null===(t=W.find(e=>e.id===u))||void 0===t?void 0:t.color,stroke:"#000",strokeWidth:"2"})]})}),(0,r.jsx)("div",{className:"mt-12 text-center z-10",children:(0,r.jsx)("h2",{className:"text-xl font-bold text-red-500 tracking-widest uppercase",children:"Planetary Beacon"})})]}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"bg-red-950/20 p-6 rounded-xl border border-red-500/20 max-h-[600px] overflow-y-auto custom-scrollbar",children:[(0,r.jsxs)("h3",{className:"text-lg font-bold text-white mb-6 uppercase tracking-wider flex items-center gap-2",children:[(0,r.jsx)(x.Z,{size:20,className:"text-red-500"})," Fabricator"]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("label",{className:"block text-xs font-bold text-red-400 uppercase tracking-widest mb-3",children:"Pole Material"}),(0,r.jsx)("div",{className:"flex gap-2",children:W.map(e=>(0,r.jsx)("button",{onClick:()=>m(e.id),className:"flex-1 p-2 rounded text-xs uppercase font-bold border transition-all ".concat(u===e.id?"bg-red-500 text-black border-red-400":"bg-black/40 border-red-900/50 text-gray-500 hover:text-red-400"),children:e.name},e.id))})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("label",{className:"block text-xs font-bold text-red-400 uppercase tracking-widest mb-3",children:"Primary Color"}),(0,r.jsx)("div",{className:"grid grid-cols-4 gap-2",children:$.map(e=>(0,r.jsx)("button",{onClick:()=>b(e.id),className:"h-10 rounded border transition-all ".concat(p===e.id?"scale-110 border-white ring-2 ring-red-500 ring-offset-2 ring-offset-black":"border-transparent opacity-70 hover:opacity-100"),style:{backgroundColor:e.hex}},"p-".concat(e.id)))})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("label",{className:"block text-xs font-bold text-red-400 uppercase tracking-widest mb-3",children:"Secondary Color"}),(0,r.jsx)("div",{className:"grid grid-cols-4 gap-2",children:$.map(e=>(0,r.jsx)("button",{onClick:()=>f(e.id),className:"h-10 rounded border transition-all ".concat(v===e.id?"scale-110 border-white ring-2 ring-red-500 ring-offset-2 ring-offset-black":"border-transparent opacity-70 hover:opacity-100"),style:{backgroundColor:e.hex}},"s-".concat(e.id)))})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("label",{className:"block text-xs font-bold text-red-400 uppercase tracking-widest mb-3",children:"Pattern"}),(0,r.jsx)("div",{className:"grid grid-cols-2 gap-2",children:Q.map(e=>(0,r.jsx)("button",{onClick:()=>h(e.id),className:"p-3 rounded border text-left text-xs uppercase font-bold transition-all ".concat(g===e.id?"bg-red-500/20 border-red-400 text-white":"bg-black/30 border-red-900/30 text-gray-500 hover:bg-red-900/20"),children:e.name},e.id))})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("label",{className:"block text-xs font-bold text-red-400 uppercase tracking-widest mb-3",children:"Banner Shape"}),(0,r.jsx)("div",{className:"flex gap-2",children:["rectangle","pennant","check","swallowtail"].map(e=>(0,r.jsx)("button",{onClick:()=>y(e),className:"flex-1 p-2 rounded border text-[10px] uppercase font-bold transition-all ".concat(j===e?"bg-white text-black":"bg-black/50 border-white/20 text-gray-400 hover:bg-white/10"),children:"swallowtail"===e?"Tail":e},e))})]})]}),(0,r.jsxs)("button",{onClick:w,disabled:c,className:"w-full py-4 rounded-xl flex items-center justify-center gap-3 font-bold uppercase tracking-widest transition-all ".concat(c?"bg-gray-700 text-gray-400 cursor-wait":"bg-red-600 hover:bg-red-500 text-black hover:scale-[1.02] shadow-[0_0_20px_rgba(220,38,38,0.4)]"),children:[(0,r.jsx)(N.Z,{size:20}),c?"Forging...":"Fabricate Flag"]})]})]})}function et(e){let{onNavigate:t}=e,{userData:a}=(0,l.useAuth)(),[i,n]=(0,s.useState)(!1),[d,c]=(0,s.useState)("yearly"),o={monthly:"price_1SxvYuRt6vQIRlSNrYYpogpw",yearly:"price_1SxvZNRt6vQIRlSNVgvCKL89"},x=async()=>{if(null==a?void 0:a.uid){n(!0);try{let e="monthly"===d?o.monthly:o.yearly,t=await fetch("/api/stripe/checkout",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({priceId:e,userId:a.uid,email:a.email})});if(!t.ok)throw Error("Network response was not ok");let{url:r}=await t.json();if(r)window.location.href=r;else throw Error("No Checkout URL returned")}catch(e){console.error(e),alert("Checkout initialization failed. Check console.")}n(!1)}};return(0,r.jsxs)("div",{className:"max-w-4xl mx-auto border border-green-500/30 bg-black/40 rounded-3xl p-8 flex flex-col gap-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4 border-b border-green-500/30 pb-4",children:[(0,r.jsx)("div",{className:"p-3 bg-green-500/20 rounded-xl border border-green-500 text-green-400",children:(0,r.jsx)(k.Z,{size:24})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-white uppercase tracking-widest",children:"Subscription Management"}),(0,r.jsxs)("p",{className:"text-gray-400 text-xs mt-1 uppercase tracking-widest",children:["Plan Status: ",(0,r.jsx)("span",{className:(null==a?void 0:a.subscriptionStatus)==="active"?"text-green-400 font-bold":"text-yellow-400 font-bold",children:(null==a?void 0:a.subscriptionStatus)||"TRIAL"})]})]})]}),(0,r.jsxs)("div",{className:"grid md:grid-cols-2 gap-8",children:[(0,r.jsxs)("div",{className:"bg-white/5 rounded-2xl p-6 border border-white/10 flex flex-col",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h3",{className:"text-xl font-bold text-white mb-2",children:"Free Trial"}),(0,r.jsx)("p",{className:"text-gray-400 text-sm mb-4",children:"Perfect for small groups or testing the waters."}),(0,r.jsxs)("ul",{className:"space-y-3 text-sm text-gray-300 mb-8",children:[(0,r.jsxs)("li",{className:"flex items-center gap-2",children:[(0,r.jsx)(m.Z,{size:16,className:"text-green-400"})," Up to 5 Students"]}),(0,r.jsxs)("li",{className:"flex items-center gap-2",children:[(0,r.jsx)(m.Z,{size:16,className:"text-green-400"})," Explore All Features"]}),(0,r.jsxs)("li",{className:"flex items-center gap-2",children:[(0,r.jsx)(m.Z,{size:16,className:"text-green-400"})," Unlimited Duration"]})]})]}),(null==a?void 0:a.subscriptionStatus)!=="active"&&(0,r.jsx)("div",{className:"w-full py-3 rounded-xl bg-white/5 text-white/40 font-bold border border-white/10 text-center uppercase tracking-wider text-xs",children:"Current Status"})]}),(0,r.jsxs)("div",{className:"bg-gradient-to-br from-green-900/20 to-black rounded-2xl p-6 border border-green-500/50 flex flex-col relative overflow-hidden",children:[(0,r.jsx)("div",{className:"absolute top-0 right-0 bg-green-500 text-black text-xs font-bold px-3 py-1 rounded-bl-xl uppercase tracking-wider",children:"Recommended"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h3",{className:"text-xl font-bold text-green-400 mb-4",children:"Full Access"}),(0,r.jsxs)("div",{className:"flex bg-black/40 p-1 rounded-lg border border-white/10 w-fit mb-6",children:[(0,r.jsx)("button",{onClick:()=>c("monthly"),className:"px-4 py-2 rounded-md text-sm font-bold transition-all ".concat("monthly"===d?"bg-green-600 text-white shadow-lg":"text-gray-400 hover:text-white"),children:"Monthly"}),(0,r.jsx)("button",{onClick:()=>c("yearly"),className:"px-4 py-2 rounded-md text-sm font-bold transition-all ".concat("yearly"===d?"bg-green-600 text-white shadow-lg":"text-gray-400 hover:text-white"),children:"Yearly"})]}),"yearly"===d?(0,r.jsxs)("div",{className:"flex items-baseline gap-1 mb-4",children:[(0,r.jsx)("span",{className:"text-3xl font-bold text-white",children:"$100"}),(0,r.jsx)("span",{className:"text-sm text-gray-400",children:"/year"}),(0,r.jsx)("span",{className:"text-xs text-green-400 ml-2 font-bold bg-green-900/30 px-2 py-1 rounded",children:"SAVE $20"})]}):(0,r.jsxs)("div",{className:"flex items-baseline gap-1 mb-4",children:[(0,r.jsx)("span",{className:"text-3xl font-bold text-white",children:"$10"}),(0,r.jsx)("span",{className:"text-sm text-gray-400",children:"/month"})]}),(0,r.jsxs)("ul",{className:"space-y-3 text-sm text-gray-300 mb-8",children:[(0,r.jsxs)("li",{className:"flex items-center gap-2",children:[(0,r.jsx)(m.Z,{size:16,className:"text-green-400"})," Up to 30 Students"]}),(0,r.jsxs)("li",{className:"flex items-center gap-2",children:[(0,r.jsx)(m.Z,{size:16,className:"text-green-400"})," Custom Missions & Planets"]}),(0,r.jsxs)("li",{className:"flex items-center gap-2",children:[(0,r.jsx)(m.Z,{size:16,className:"text-green-400"})," Priority Support"]}),(0,r.jsxs)("li",{className:"flex items-center gap-2",children:[(0,r.jsx)(m.Z,{size:16,className:"text-green-400"})," Full Analytic Dashboard"]})]})]}),(null==a?void 0:a.subscriptionStatus)==="active"?(0,r.jsxs)("div",{className:"w-full py-3 rounded-xl bg-green-500/20 text-green-400 font-bold border border-green-500/50 text-center uppercase tracking-wider flex items-center justify-center gap-2",children:[(0,r.jsx)(m.Z,{size:18})," Plan Active"]}):(0,r.jsx)("button",{onClick:x,disabled:i,className:"w-full py-3 rounded-xl font-bold transition-all border shadow-[0_0_20px_rgba(22,163,74,0.3)]\n                                ".concat(i?"bg-gray-700 text-gray-400 border-gray-600 cursor-wait":"bg-green-600 hover:bg-green-500 text-white border-green-400 active:scale-95","\n                            "),children:i?"Initializing...":"Upgrade (".concat(d,")")})]})]}),(0,r.jsxs)("div",{className:"mt-4 p-4 bg-blue-900/10 border border-blue-500/30 rounded-xl flex items-start gap-4",children:[(0,r.jsx)(S.Z,{className:"text-blue-400 shrink-0 mt-1"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-blue-300 font-bold text-sm uppercase tracking-wider mb-1",children:"Teacher Guarantee"}),(0,r.jsx)("p",{className:"text-gray-400 text-xs leading-relaxed",children:'We believe in this tool. If you don"t see an increase in student engagement within the first 30 days, we"ll refund your subscription in full. No questions asked.'})]})]})]})}function ea(e){let{onNavigate:t}=e,{userData:a}=(0,l.useAuth)(),[d,c]=(0,s.useState)(""),[o,x]=(0,s.useState)(!1),[u,m]=(0,s.useState)(null),g=async e=>{if(e.preventDefault(),d&&(null==a?void 0:a.uid)){x(!0),m(null);try{await (0,i.r7)((0,i.JU)(n.db,"users",a.uid),{coTeacherEmails:(0,i.vr)(d.trim())}),c("")}catch(e){m(e.message)}x(!1)}},h=async e=>{if((null==a?void 0:a.uid)&&confirm("Revoke access for ".concat(e,"?")))try{await (0,i.r7)((0,i.JU)(n.db,"users",a.uid),{coTeacherEmails:(0,i.Ab)(e)})}catch(e){m(e.message)}};return(0,r.jsxs)("div",{className:"max-w-4xl mx-auto border border-blue-500/30 bg-black/40 rounded-3xl p-8 flex flex-col gap-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4 border-b border-blue-500/30 pb-4",children:[(0,r.jsx)("div",{className:"p-3 bg-blue-500/20 rounded-xl border border-blue-500 text-blue-400",children:(0,r.jsx)(C.Z,{size:24})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-white uppercase tracking-widest",children:"Command Team"}),(0,r.jsx)("p",{className:"text-gray-400 text-xs mt-1 uppercase tracking-widest",children:"Grant access to other educators"})]})]}),(0,r.jsxs)("div",{className:"bg-white/5 rounded-2xl p-6 border border-white/10",children:[(0,r.jsx)("h3",{className:"text-lg font-bold text-white mb-4",children:"Authorized Officers"}),(null==a?void 0:a.coTeacherEmails)&&0!==a.coTeacherEmails.length?(0,r.jsx)("div",{className:"space-y-3",children:a.coTeacherEmails.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 bg-black/40 rounded-lg border border-white/5",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-full bg-blue-500/20 text-blue-400 flex items-center justify-center font-bold",children:e[0].toUpperCase()}),(0,r.jsx)("span",{className:"text-gray-200 font-mono",children:e})]}),(0,r.jsx)("button",{onClick:()=>h(e),className:"p-2 hover:bg-white/10 rounded-lg text-red-400 transition-colors",title:"Revoke Access",children:(0,r.jsx)(P.Z,{size:18})})]},e))}):(0,r.jsx)("p",{className:"text-gray-500 italic text-sm",children:"No co-teachers assigned."})]}),(0,r.jsxs)("form",{onSubmit:g,className:"bg-blue-900/10 border border-blue-500/20 rounded-2xl p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-bold text-blue-300 mb-4",children:"Add Officer"}),(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsx)("input",{type:"email",value:d,onChange:e=>c(e.target.value),placeholder:"teacher@school.edu",className:"flex-1 bg-black/50 border border-blue-500/30 rounded-xl px-4 py-3 text-white placeholder-blue-500/30 focus:outline-none focus:border-blue-400",required:!0}),(0,r.jsx)("button",{type:"submit",disabled:o,className:"bg-blue-500 hover:bg-blue-400 text-black font-bold uppercase tracking-wider px-6 rounded-xl transition-all disabled:opacity-50",children:o?"Saving...":"Grant"})]}),u&&(0,r.jsx)("p",{className:"text-red-400 text-xs mt-2",children:u}),(0,r.jsx)("p",{className:"text-blue-400/50 text-[10px] uppercase tracking-widest mt-4",children:"Note: The user must log in with this Google Email to access your class data."})]})]})}function er(e){let{onNavigate:t}=e,{userData:a}=(0,l.useAuth)(),[d,c]=(0,s.useState)(30),[o,x]=(0,s.useState)(1e3),[u,m]=(0,s.useState)("5 Minutes of Extra Recess"),[g,h]=(0,s.useState)("No Penalty"),[p,b]=(0,s.useState)("idle"),[v,f]=(0,s.useState)(!1),[j,y]=(0,s.useState)(null),[w,N]=(0,s.useState)(null),[k,S]=(0,s.useState)(0);(0,s.useEffect)(()=>{if(!(null==a?void 0:a.uid))return;let e="asteroidEvent_".concat(a.uid),t=(0,i.cf)((0,i.JU)(n.db,"game-config",e),e=>{if(e.exists()){let t=e.data();b(t.active?"active":t.status),N(t),t.active&&t.startTime&&S(Math.max(0,Math.ceil((t.startTime+1e3*t.duration-Date.now())/1e3)))}else b("idle"),N(null)});return()=>t()},[a]),(0,s.useEffect)(()=>{if("active"!==p)return;let e=setInterval(()=>{(null==w?void 0:w.startTime)&&S(Math.max(0,Math.ceil((w.startTime+1e3*w.duration-Date.now())/1e3)))},1e3);return()=>clearInterval(e)},[p,w]);let C=async()=>{if(null==a?void 0:a.uid){f(!0),y(null);try{let e=(0,i.hJ)(n.db,"users"),t=(0,i.IO)(e,(0,i.ar)("teacherId","==",a.uid)),r=await (0,i.PL)(t),s=0;r.forEach(e=>{let t=e.data();s+=t.xp||0});let l="asteroidEvent_".concat(a.uid);await (0,i.pl)((0,i.JU)(n.db,"game-config",l),{active:!0,startTime:Date.now(),duration:60*d,targetXP:o,startClassXP:s,reward:u,penalty:g,status:"active"}),b("active")}catch(e){console.error(e),y("Launch Failed: "+e.message)}f(!1)}},P=async()=>{if(!(null==a?void 0:a.uid))return;f(!0);let e="asteroidEvent_".concat(a.uid);try{await (0,i.r7)((0,i.JU)(n.db,"game-config",e),{active:!1,status:"failed"})}catch(e){y(e.message)}f(!1)};return(0,r.jsxs)("div",{className:"max-w-4xl mx-auto border border-orange-500/30 bg-black/40 rounded-3xl p-8 flex flex-col gap-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4 border-b border-orange-500/30 pb-4",children:[(0,r.jsx)("div",{className:"p-3 bg-orange-500/20 rounded-xl border border-orange-500 text-orange-400",children:(0,r.jsx)(_.Z,{size:32})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-white uppercase tracking-widest",children:"Planetary Defense"}),(0,r.jsx)("p",{className:"text-orange-400 text-xs font-mono uppercase",children:"Emergency Override System"})]})]}),j&&(0,r.jsxs)("div",{className:"p-4 bg-red-900/50 border border-red-500 text-red-200 rounded-xl font-bold flex items-center gap-2",children:[(0,r.jsx)(_.Z,{size:20}),j]}),"active"===p?(0,r.jsxs)("div",{className:"bg-red-900/20 border border-red-500/50 p-8 rounded-xl text-center flex flex-col items-center",children:[(0,r.jsx)("div",{className:"animate-pulse mb-6 p-4 bg-red-500/20 rounded-full border border-red-500 shadow-[0_0_50px_rgba(239,68,68,0.4)]",children:(0,r.jsx)(_.Z,{size:64,className:"text-red-500"})}),(0,r.jsx)("h3",{className:"text-3xl font-bold text-red-500 uppercase tracking-widest mb-2",children:"Event in Progress"}),(0,r.jsxs)("div",{className:"text-4xl font-mono text-white mb-6 font-bold tabular-nums tracking-widest",children:[Math.floor(k/60),":",(k%60).toString().padStart(2,"0")]}),(0,r.jsx)("p",{className:"text-white/60 mb-8 max-w-md",children:"The class is currently defending against the asteroid. Monitor student XP gains on the dashboard."}),(0,r.jsx)("button",{onClick:P,disabled:v,className:"bg-red-600 px-8 py-4 rounded-xl text-black font-bold uppercase tracking-wider hover:bg-red-500 transition-all hover:scale-105 shadow-lg",children:v?"Aborting...":"Abort Mission"})]}):(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-8",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-orange-400 text-xs font-bold uppercase mb-2 block",children:"Event Duration (Minutes)"}),(0,r.jsx)("div",{className:"flex gap-2",children:(0,r.jsx)("input",{type:"number",min:"1",max:"120",value:d,onChange:e=>c(Math.max(1,Number(e.target.value))),className:"w-full bg-black border border-orange-500/30 rounded p-3 text-white"})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-orange-400 text-xs font-bold uppercase mb-2 block",children:"XP Target (Incremental)"}),(0,r.jsx)("input",{type:"number",value:o,onChange:e=>x(Number(e.target.value)),className:"w-full bg-black border border-orange-500/30 rounded p-3 text-white"}),(0,r.jsx)("p",{className:"text-[10px] text-orange-500/60 mt-1",children:"Amount of NEW XP the class must earn collectively."})]})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-orange-400 text-xs font-bold uppercase mb-2 block",children:"Victory Reward"}),(0,r.jsx)("input",{type:"text",value:u,onChange:e=>m(e.target.value),className:"w-full bg-black border border-orange-500/30 rounded p-3 text-white"})]}),(0,r.jsx)("button",{onClick:C,disabled:v,className:"w-full py-4 bg-orange-600 hover:bg-orange-500 disabled:bg-gray-700 disabled:text-gray-500 text-black font-bold rounded-xl text-xl uppercase tracking-widest shadow-[0_0_30px_rgba(249,115,22,0.4)] transition-all",children:v?"Initializing Sensors...":" Initiate Alert"})]})]})]})}let es=[{id:"1",name:"Space Cadet",minXP:0,image:(0,d.K)("/images/badges/cadet.png")},{id:"2",name:"Rookie Pilot",minXP:100,image:(0,d.K)("/images/badges/RookiePilot.png")},{id:"3",name:"Star Scout",minXP:300,image:(0,d.K)("/images/badges/StarScout.png")},{id:"4",name:"Nebula Navigator",minXP:600,image:(0,d.K)("/images/badges/NebulaNavigator.png")},{id:"5",name:"Solar Specialist",minXP:1e3,image:(0,d.K)("/images/badges/SolarSpecialist.png")},{id:"6",name:"Comet Captain",minXP:1500,image:(0,d.K)("/images/badges/CometCaptain.png")},{id:"7",name:"Galaxy Guardian",minXP:2200,image:(0,d.K)("/images/badges/GalaxyGuardian.png")},{id:"8",name:"Cosmic Commander",minXP:3e3,image:(0,d.K)("/images/badges/CosmicCommander.png")},{id:"9",name:"Void Admiral",minXP:4e3,image:(0,d.K)("/images/badges/VoidAdmiral.png")},{id:"10",name:"Grand Star Admiral",minXP:5e3,image:(0,d.K)("/images/badges/GrandStarAdmiral.png")}];function el(){return(0,r.jsx)(s.Suspense,{fallback:(0,r.jsx)("div",{className:"min-h-screen bg-space-950 flex items-center justify-center text-cyan-500",children:"Loading Systems..."}),children:(0,r.jsx)(ei,{})})}function ei(){let{userData:e,user:t}=(0,l.useAuth)(),a=(0,F.useSearchParams)(),[d,c]=(0,s.useState)("cockpit"),[o,x]=(0,s.useState)(es),[u,m]=(0,s.useState)(!1);(0,s.useEffect)(()=>{let e=a.get("mode"),t=a.get("success"),r=a.get("canceled");t&&c("billing"),r&&c("billing"),"asteroids"===e?c("asteroids"):"team"===e?c("team"):"billing"===e?c("billing"):"ranks"===e&&(c("cockpit"),setTimeout(()=>m(!0),100))},[a]),(0,s.useEffect)(()=>{let e=(0,i.cf)((0,i.JU)(n.db,"game-config","ranks"),e=>{e.exists()&&e.data().list&&x(e.data().list)});return()=>e()},[]);let{logout:g}=(0,l.useAuth)();return(0,r.jsxs)("div",{className:"min-h-screen bg-space-950 p-6 font-mono pb-20 overflow-x-hidden",children:[(0,r.jsx)("div",{className:"fixed inset-0 bg-[linear-gradient(to_right,#4f4f4f2e_1px,transparent_1px),linear-gradient(to_bottom,#4f4f4f2e_1px,transparent_1px)] bg-[size:4rem_4rem] [mask-image:radial-gradient(ellipse_60%_50%_at_50%_0%,#000_70%,transparent_100%)] pointer-events-none"}),(0,r.jsxs)("div",{className:"max-w-7xl mx-auto relative z-10",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:["cockpit"===d?(0,r.jsxs)(T.default,{href:"/teacher",className:"p-3 rounded-xl border border-white/10 hover:bg-white/5 text-white/50 hover:text-white transition-all",children:[(0,r.jsx)(z.Z,{size:20}),(0,r.jsx)("span",{className:"sr-only",children:"Exit Cockpit"})]}):(0,r.jsx)("button",{onClick:()=>c("avatar-config"===d?"avatar":"cockpit"),className:"p-3 rounded-xl border border-white/10 hover:bg-white/5 text-white/50 hover:text-white transition-all",children:(0,r.jsx)(H.Z,{size:20})}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("h1",{className:"text-3xl font-bold uppercase tracking-widest text-white flex items-center gap-3",children:[(0,r.jsx)(Z.Z,{className:"text-cyan-500 animate-spin-slow"}),(()=>{switch(d){case"ship":return"Hangar Bay";case"inventory":return"Cargo Hold";case"avatar":return"Pilot Profile";case"avatar-config":return"DNA Sequencer";case"flag":return"Flag Fabricator";case"asteroids":return"Defense Systems";default:return"Main Cockpit"}})()]}),(0,r.jsx)("div",{className:"text-xs text-cyan-500/50 uppercase tracking-[0.3em]",children:"System Status: Normal"})]})]}),(0,r.jsx)("button",{onClick:g,className:"p-3 rounded-xl border border-red-500/20 bg-red-500/10 text-red-400 hover:bg-red-500/20 hover:text-red-300 transition-all flex items-center gap-2",title:"Sign Out",children:(0,r.jsx)(p.Z,{size:20})})]}),(0,r.jsx)(I.M,{mode:"wait",children:(0,r.jsxs)(A.E.div,{initial:{opacity:0,scale:.95,filter:"blur(10px)"},animate:{opacity:1,scale:1,filter:"blur(0px)"},exit:{opacity:0,scale:1.05,filter:"blur(10px)"},transition:{duration:.3},children:["cockpit"===d&&(0,r.jsx)(B,{onNavigate:e=>c(e),ranks:o,onOpenRankEditor:()=>m(!0)}),"ship"===d&&(0,r.jsx)(V,{userData:e,user:t}),"inventory"===d&&(0,r.jsx)(J,{}),"avatar"===d&&(0,r.jsx)(q,{onNavigate:e=>c(e),ranks:o}),"avatar-config"===d&&(0,r.jsx)(Y,{onBack:()=>c("avatar")}),"flag"===d&&(0,r.jsx)(ee,{}),"asteroids"===d&&(0,r.jsx)(er,{onNavigate:e=>c(e)}),"billing"===d&&(0,r.jsx)(et,{onNavigate:e=>c(e)}),"team"===d&&(0,r.jsx)(ea,{onNavigate:e=>c(e)})]},d)}),(0,r.jsx)(R,{isOpen:u,onClose:()=>m(!1)})]})]})}},5802:function(e,t,a){"use strict";a.d(t,{Cn:function(){return n},Ic:function(){return i},W$:function(){return l},Yt:function(){return d}});var r=a(3827),s=a(1657);let l=[{id:"bunny",name:"Space Bunny",src:"/images/avatar/spacebunny.png"},{id:"cat",name:"Cosmic Cat",src:"/images/avatar/spacecat.png"},{id:"raccoon",name:"Rocket Raccoon",src:"/images/avatar/spaceraccoon.png"},{id:"otter",name:"Orbit Otter",src:"/images/avatar/spaceotter.png"},{id:"pup",name:"Pluto Pup",src:"/images/avatar/spacepup.png"},{id:"hamster",name:"Hyper Hamster",src:"/images/avatar/spacehamster.png"},{id:"owl",name:"Omega Owl",src:"/images/avatar/spaceowl.png"},{id:"penguin",name:"Power Penguin",src:"/images/avatar/spacepenguin.png"},{id:"turtle",name:"Turbo Turtle",src:"/images/avatar/spaceturtle.png"}],i=[{id:"p1",name:"Cadet Blue",config:{hue:0,skinHue:200,bgHue:240,bgSat:60,bgLight:50,activeHat:"none",avatarId:"bunny"}},{id:"p2",name:"Crimson Guard",config:{hue:350,skinHue:0,bgHue:0,bgSat:70,bgLight:40,activeHat:"none",avatarId:"cat"}},{id:"p3",name:"Forest Ranger",config:{hue:120,skinHue:100,bgHue:120,bgSat:50,bgLight:60,activeHat:"none",avatarId:"raccoon"}},{id:"p4",name:"Solar Pilot",config:{hue:45,skinHue:60,bgHue:40,bgSat:90,bgLight:70,activeHat:"none",avatarId:"otter"}},{id:"p5",name:"Void Walker",config:{hue:270,skinHue:260,bgHue:280,bgSat:40,bgLight:20,activeHat:"none",avatarId:"pup"}},{id:"p6",name:"Neon Scout",config:{hue:180,skinHue:300,bgHue:320,bgSat:100,bgLight:50,activeHat:"none",avatarId:"cat"}},{id:"p7",name:"Rusty Mechanic",config:{hue:25,skinHue:30,bgHue:15,bgSat:50,bgLight:40,activeHat:"none",avatarId:"raccoon"}},{id:"p8",name:"Ice Specialist",config:{hue:190,skinHue:180,bgHue:200,bgSat:70,bgLight:90,activeHat:"none",avatarId:"bunny"}}],n=[{id:"none",name:"No Hat",src:"",style:""},{id:"hat1",name:"Helmet",src:"/images/hats/helmet1.png",style:"scale-[2.5] translate-y-[45%]"},{id:"hat2",name:"Fedora",src:"/images/hats/hat2.png",style:"scale-[0.9] -translate-y-[40%]"},{id:"hat3",name:"Top Hat",src:"/images/hats/tophat.png",style:"scale-[0.9] -translate-y-[40%]"},{id:"hat4",name:"Cowboy Hat",src:"/images/hats/cowboyhat.png",style:"scale-[0.9] -translate-y-[40%]"},{id:"hat5",name:"Dungan Doves Cap",src:"/images/hats/dungandoves.png",style:"scale-[0.9] -translate-y-[40%]"}],d=e=>{var t,a,i,d,c,o,x,u,m,g,h,p,b,v,f,j,y;let{userData:w,hue:N,skinHue:k,bgHue:S,bgSat:C,bgLight:P,hat:_,avatarId:z,className:H=""}=e,Z=null!==(m=null!=N?N:null==w?void 0:null===(t=w.avatar)||void 0===t?void 0:t.hue)&&void 0!==m?m:0,E=null!==(g=null!=k?k:null==w?void 0:null===(a=w.avatar)||void 0===a?void 0:a.skinHue)&&void 0!==g?g:0,I=null!==(h=null!=S?S:null==w?void 0:null===(i=w.avatar)||void 0===i?void 0:i.bgHue)&&void 0!==h?h:260,A=null!==(p=null!=C?C:null==w?void 0:null===(d=w.avatar)||void 0===d?void 0:d.bgSat)&&void 0!==p?p:50,X=null!==(b=null!=P?P:null==w?void 0:null===(c=w.avatar)||void 0===c?void 0:c.bgLight)&&void 0!==b?b:20,L=null!==(v=null!=z?z:null==w?void 0:null===(o=w.avatar)||void 0===o?void 0:o.avatarId)&&void 0!==v?v:"bunny",M=l.find(e=>e.id===L)||l[0],R=(null==M?void 0:M.src)||"/images/avatar/spacebunny.png",T=null!==(y=null!==(j=null!==(f=null!=_?_:null==w?void 0:w.activeHat)&&void 0!==f?f:null==w?void 0:null===(x=w.avatar)||void 0===x?void 0:x.activeHat)&&void 0!==j?j:null==w?void 0:null===(u=w.avatar)||void 0===u?void 0:u.hat)&&void 0!==y?y:"none",F=n.find(e=>e.id===T),U=null==F?void 0:F.src,D=(null==F?void 0:F.style)||"scale-100";return(0,r.jsxs)("div",{className:"relative ".concat(H),style:{backgroundColor:"hsl(".concat(I,", ").concat(A,"%, ").concat(X,"%)")},children:[(0,r.jsx)("div",{className:"absolute inset-0 z-0",style:{backgroundColor:"hsl(".concat(E,", 70%, 50%)"),maskImage:"url(".concat((0,s.K)(R),")"),WebkitMaskImage:"url(".concat((0,s.K)(R),")"),maskSize:"cover"}}),(0,r.jsx)("img",{src:(0,s.K)(R),alt:"Avatar",className:"w-full h-full object-cover relative z-10",style:{filter:"hue-rotate(".concat(Z,"deg)")}}),U&&(0,r.jsx)("img",{src:(0,s.K)(U),alt:"Accessory",className:"absolute inset-0 z-20 w-full h-full object-cover pointer-events-none transition-transform ".concat(D),onError:e=>console.error("Error loading hat:",U,(0,s.K)(U))})]})}},6678:function(e,t,a){"use strict";a.r(t),a.d(t,{AuthProvider:function(){return x},useAuth:function(){return u}});var r=a(3827),s=a(4090),l=a(7065),i=a(8121),n=a(4499),d=a(7907),c=a(1657);let o=(0,s.createContext)({});function x(e){let{children:t}=e,[a,x]=(0,s.useState)(null),[u,m]=(0,s.useState)(null),[g,h]=(0,s.useState)(!0),p=(0,d.useRouter)();(0,s.useEffect)(()=>{let e=(0,l.Aj)(n.I8,async e=>{if(x(e),e)try{let a=(0,i.JU)(n.db,"users",e.uid),r=await (0,i.QT)(a);if(r.exists()){let t=r.data(),s="andrewpcarlson85@gmail.com"===e.email,l={};if(s&&"teacher"!==t.role&&(console.log("Fixing Admin Role for Legacy User"),t.role="teacher",l.role="teacher"),"teacher"===t.role&&!t.classCode){console.log("Generating Class Code for existing teacher");let e=(0,c.a)();t.classCode=e,l.classCode=e}if(Object.keys(l).length>0)try{await (0,i.pl)(a,l,{merge:!0})}catch(e){console.warn("Could not update user profile in DB",e)}m(t)}else{var t;e.email;let r={uid:e.uid,email:e.email,displayName:e.displayName,photoURL:e.photoURL,role:"teacher",classCode:(0,c.a)(),status:"active",subscriptionStatus:"trial",schoolName:"",location:"earth",spaceship:{name:"SS "+((null===(t=e.displayName)||void 0===t?void 0:t.split(" ")[0])||"Voyager"),color:"text-blue-400",type:"scout",speed:1}};await (0,i.pl)(a,r),m(r)}}catch(t){console.error("Error fetching user data",t),"andrewpcarlson85@gmail.com"===e.email&&(console.log("Using Fallback Admin Profile due to DB error"),m({uid:e.uid,email:e.email,displayName:e.displayName,photoURL:e.photoURL,role:"teacher",status:"active",location:"earth",xp:9999,spaceship:{name:"SS Command (Fallback)",color:"text-yellow-400",type:"fighter",speed:2}}))}else m(null);h(!1)});return()=>e()},[]);let b=async()=>{try{await (0,l.rh)(n.I8,n.Vv)}catch(e){console.error("Login failed",e)}},v=async(e,t)=>{try{await (0,l.e5)(n.I8,e,t)}catch(e){throw console.error("Student Login Failed",e),e}},f=async()=>{await (0,l.w7)(n.I8),m(null),p.push("/")};return(0,r.jsx)(o.Provider,{value:{user:a,userData:u,loading:g,signInWithGoogle:b,signInStudent:v,logout:f},children:t})}let u=()=>(0,s.useContext)(o)},4499:function(e,t,a){"use strict";a.d(t,{I8:function(){return o},Vv:function(){return x},db:function(){return c},qe:function(){return n}});var r=a(6142),s=a(8121),l=a(7065),i=a(3493);let n={apiKey:"AIzaSyDVHiiCHkP-RFOI26cIrD_OijLnw1r3B8Q",authDomain:"spaceadventure-7d540.firebaseapp.com",projectId:"spaceadventure-7d540",storageBucket:"spaceadventure-7d540.firebasestorage.app",messagingSenderId:"546441300465",appId:"1:546441300465:web:28ae387d2bdbb8011a1c50",measurementId:"G-8R9PYL00XH"},d=(0,r.C6)().length>0?(0,r.Mq)():(0,r.ZF)(n),c=(0,s.ad)(d),o=(0,l.v0)(d),x=new l.hJ;(0,i.Gb)().then(e=>{e&&(0,i.IH)(d)})},1657:function(e,t,a){"use strict";a.d(t,{K:function(){return r},a:function(){return s}});let r=e=>{let t=e.startsWith("/")?e:"/".concat(e);return window.location.hostname.includes("github.io")?"https://shootyq.github.io/SpaceAdventure".concat(t):"".concat("").concat(t)},s=()=>{let e="ABCDEFGHJKLMNPQRSTUVWXYZ23456789",t="";for(let a=0;a<6;a++)t+=e.charAt(Math.floor(Math.random()*e.length));return t}},1524:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(7461).Z)("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},9259:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(7461).Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},527:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(7461).Z)("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},1049:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(7461).Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},5421:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(7461).Z)("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]])},94:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(7461).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},8727:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(7461).Z)("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]])},489:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(7461).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},4059:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(7461).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])}},function(e){e.O(0,[358,38,911,250,55,103,971,69,744],function(){return e(e.s=1837)}),_N_E=e.O()}]);