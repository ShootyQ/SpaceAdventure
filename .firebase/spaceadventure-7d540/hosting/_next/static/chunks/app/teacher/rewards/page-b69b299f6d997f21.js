(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[825],{1540:function(e,t,a){Promise.resolve().then(a.bind(a,3841))},3841:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return v}});var n=a(3827),r=a(4090),s=a(8121),l=a(4499),i=a(6678),o=a(1657),c=a(5802),d=a(2235),u=a(7404),h=a(489),m=a(9496),p=a(9259),x=a(5879),f=a(8745),b=a(8371),g=a(8792);function v(){let[e,t]=(0,r.useState)([]),[a,v]=(0,r.useState)([]),[y,w]=(0,r.useState)([]),[j,N]=(0,r.useState)(new Set),[k,S]=(0,r.useState)(!1),[C,P]=(0,r.useState)(!1),[H,z]=(0,r.useState)(""),[I,E]=(0,r.useState)(50),{user:R}=(0,i.useAuth)(),L=e=>{let t=new Set(j);t.has(e)?t.delete(e):t.add(e),N(t)},[A,Z]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let e=()=>Z(window.innerWidth<768);return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,r.useEffect)(()=>{if(!R)return;let e=(0,s.IO)((0,s.hJ)(l.db,"users"),(0,s.ar)("role","==","student"),(0,s.ar)("status","==","active"),(0,s.ar)("teacherId","==",R.uid)),a=(0,s.cf)(e,e=>{t(e.docs.map(e=>({uid:e.id,...e.data()})))});if(!R)return;let n=(0,s.IO)((0,s.hJ)(l.db,"users/".concat(R.uid,"/behaviors"))),r=(0,s.cf)(n,e=>{let t=e.docs.map(e=>({id:e.id,...e.data()}));t.sort((e,t)=>t.xp-e.xp),v(t)}),i=(0,s.cf)((0,s.JU)(l.db,"users/".concat(R.uid,"/settings"),"ranks"),async e=>{if(e.exists()&&e.data().list)w(e.data().list);else{let e=await (0,s.QT)((0,s.JU)(l.db,"game-config","ranks"));e&&e.exists()&&e.data().list&&w(e.data().list)}});return()=>{a(),r(),i()}},[R]);let M=async e=>{if(0===j.size||!R)return;let t=Number(e.xp),a=document.getElementById("notification-audio");a&&(a.currentTime=0,a.volume=.5,a.play().catch(e=>console.error("Audio playback failed:",e)));try{let a=Array.from(j).map(async a=>{let n=(0,s.JU)(l.db,"users",a);await (0,s.i3)(l.db,async a=>{var r;let i=await a.get(n);if(!i.exists())throw"Student document not found";let o=i.data(),c=(null===(r=o.upgrades)||void 0===r?void 0:r.fuel)||0,d=500+250*c,u=(void 0!==o.fuel?o.fuel:500)+t;u>d&&(u=d),u<0&&(u=0),a.update(n,{xp:(0,s.nP)(t),fuel:u,lastXpReason:e.label});let h=o.location;if(h&&t>0){let e=h.toLowerCase(),n=(0,s.JU)(l.db,"users/".concat(R.uid,"/planets"),e);a.set(n,{currentXP:(0,s.nP)(t),id:e,teacherId:R.uid},{merge:!0})}})});await Promise.all(a),console.log("SUCCESS: Awarded ".concat(t," XP to ").concat(j.size," students.")),S(!1),z(""),N(new Set)}catch(e){console.error("Error awarding XP:",e),alert("Award Transaction Failed!\n\n".concat(e))}},O=async e=>{if(e.preventDefault(),R)try{await (0,s.ET)((0,s.hJ)(l.db,"users/".concat(R.uid,"/behaviors")),{label:H,xp:Number(I),color:Number(I)>0?"bg-green-600":"bg-red-600",teacherId:R.uid}),z(""),E(50)}catch(e){console.error("Error adding behavior:",e),alert("Failed to add protocol. ensure you have permission.")}},U=async(e,t)=>{if(t.stopPropagation(),R&&confirm("Remove this behavior?"))try{await (0,s.oe)((0,s.JU)(l.db,"users/".concat(R.uid,"/behaviors"),e))}catch(e){console.error(e)}};return(0,n.jsxs)("div",{className:"min-h-screen bg-space-950 p-2 md:p-4 font-mono text-cyan-400",children:[(0,n.jsx)("audio",{id:"notification-audio",src:(0,o.K)("/sounds/notification.m4a?v=1"),preload:"auto"}),(0,n.jsxs)("div",{className:"max-w-7xl mx-auto h-[calc(100vh-1rem)] md:h-[calc(100vh-2rem)] flex flex-col",children:[(0,n.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-4 md:mb-6 shrink-0 gap-4",children:[(0,n.jsxs)("div",{className:"flex items-center gap-4",children:[(0,n.jsx)(g.default,{href:"/teacher",className:"p-2 rounded-full border border-cyan-500/30 hover:bg-cyan-900/20 text-cyan-500",children:(0,n.jsx)(d.Z,{size:20})}),(0,n.jsx)("h1",{className:"text-xl md:text-2xl font-bold uppercase tracking-widest text-white",children:"Rewards Command"})]}),(0,n.jsx)("div",{className:"flex gap-2 w-full md:w-auto",children:(0,n.jsxs)("button",{onClick:()=>P(!C),className:"flex-1 md:flex-none flex items-center justify-center gap-2 px-4 py-3 md:py-2 rounded border transition-colors ".concat(C?"bg-cyan-900/40 border-cyan-400 text-white":"border-cyan-800 text-cyan-500 hover:border-cyan-500"),children:[(0,n.jsx)(u.Z,{size:16}),C?"DONE":"PROTOCOLS"]})})]}),(0,n.jsxs)("div",{className:"flex-1 flex flex-col md:flex-row gap-4 md:gap-6 min-h-0 overflow-hidden relative",children:[(0,n.jsx)(f.M,{children:C&&(0,n.jsx)(b.E.div,{initial:{height:0,opacity:0,width:"100%"},animate:{height:A?"auto":"100%",width:A?"100%":320,opacity:1},exit:{height:0,opacity:0,width:A?"100%":0},className:"bg-black/40 border md:border-r border-cyan-900/50 p-4 rounded-xl md:rounded-l-2xl overflow-hidden flex flex-col shrink-0 order-first",children:(0,n.jsxs)("div",{className:"w-full md:min-w-[280px]",children:[(0,n.jsx)("h3",{className:"text-white font-bold mb-4",children:"Edit Protocols"}),(0,n.jsxs)("form",{onSubmit:O,className:"bg-cyan-950/30 p-4 rounded-xl border border-cyan-800/30 mb-4 space-y-3",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"text-xs text-cyan-500 uppercase",children:"Label"}),(0,n.jsx)("input",{value:H,onChange:e=>z(e.target.value),className:"w-full bg-black/50 border border-cyan-800 rounded p-2 text-white text-sm focus:border-cyan-400 outline-none",placeholder:"e.g. Leadership",required:!0})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"text-xs text-cyan-500 uppercase",children:"XP Amount"}),(0,n.jsx)("div",{className:"flex gap-2",children:(0,n.jsx)("input",{type:"number",value:I,onChange:e=>E(Number(e.target.value)),className:"w-full bg-black/50 border border-cyan-800 rounded p-2 text-white text-sm focus:border-cyan-400 outline-none",required:!0})})]}),(0,n.jsx)("button",{className:"w-full bg-cyan-700 hover:bg-cyan-600 text-white font-bold py-3 md:py-2 rounded text-xs uppercase tracking-wider shadow-lg",children:"Add Protocol"})]}),(0,n.jsx)("div",{className:"flex-1 overflow-y-auto space-y-2 pr-2 max-h-[300px] md:max-h-[calc(100vh-350px)] custom-scrollbar",children:a.map(e=>(0,n.jsxs)("div",{className:"flex items-center justify-between p-3 bg-cyan-900/20 rounded border border-cyan-800/50",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"text-white text-sm font-bold",children:e.label}),(0,n.jsxs)("div",{className:"text-xs ".concat(e.xp>0?"text-green-400":"text-red-400"),children:[e.xp>0?"+":"",e.xp," XP"]})]}),(0,n.jsx)("button",{onClick:t=>U(e.id,t),className:"p-2 text-red-500 hover:text-white hover:bg-red-500/20 rounded",children:(0,n.jsx)(h.Z,{size:16})})]},e.id))})]})})}),(0,n.jsxs)("div",{className:"flex-1 bg-black/20 rounded-2xl p-2 md:p-4 overflow-hidden flex flex-col border border-white/5 relative",children:[(0,n.jsxs)("div",{className:"mb-4 flex items-center justify-between shrink-0 px-2",children:[(0,n.jsxs)("h2",{className:"text-lg md:text-xl font-bold text-white uppercase tracking-widest flex items-center gap-2",children:[(0,n.jsx)(m.Z,{className:"text-cyan-400",size:20}),(0,n.jsx)("span",{className:"hidden md:inline",children:"Active Fleet"}),(0,n.jsx)("span",{className:"md:hidden",children:"Fleet"})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("button",{onClick:()=>{j.size===e.length?N(new Set):N(new Set(e.map(e=>e.uid)))},className:"text-xs font-bold text-cyan-400 bg-cyan-950/50 hover:bg-cyan-900 border border-cyan-800 px-3 py-1.5 rounded uppercase tracking-wider transition-colors",children:j.size===e.length&&e.length>0?"Deselect All":"Select All"}),(0,n.jsxs)("div",{className:"text-xs text-cyan-600 font-bold bg-cyan-950/50 px-3 py-1 rounded-full",children:[e.length," Cadets"]})]})]}),0===e.length?(0,n.jsx)("div",{className:"flex-1 flex items-center justify-center text-cyan-800",children:(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"mb-2",children:"No active signals detected."}),(0,n.jsx)("p",{className:"text-sm",children:"Approve cadets in the Roster to see them here."})]})}):(0,n.jsx)("div",{className:"flex-1 overflow-y-auto pr-2 custom-scrollbar pb-24",children:(0,n.jsx)("div",{className:"grid grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-2 md:gap-4 auto-rows-fr",children:e.map(e=>{var t,a,r,s,l;let i=y.slice().sort((e,t)=>t.minXP-e.minXP).find(t=>(e.xp||0)>=t.minXP),d=j.has(e.uid);return(0,n.jsxs)(b.E.button,{whileTap:{scale:.95},onClick:()=>L(e.uid),className:"\n                                                relative w-full aspect-square md:aspect-square flex flex-col p-1 md:p-4 rounded-lg md:rounded-2xl border transition-all cursor-pointer group overflow-hidden\n                                                ".concat(d?"bg-cyan-900/60 border-cyan-400 shadow-[0_0_10px_rgba(6,182,212,0.3)]":"bg-black/40 border-cyan-900/50 hover:bg-cyan-900/40 hover:border-cyan-400","\n                                            "),children:[(0,n.jsxs)("div",{className:"absolute top-1 left-1 md:top-2 md:left-2 z-20 w-4 h-4 md:w-6 md:h-6 rounded-full border md:border-2 flex items-center justify-center transition-all ".concat(d?"bg-cyan-500 border-cyan-500 scale-100":"border-white/20 scale-75 opacity-50"),children:[d&&(0,n.jsx)(p.Z,{size:12,className:"text-black stroke-[4] block md:hidden"}),d&&(0,n.jsx)(p.Z,{size:14,className:"text-black stroke-[4] hidden md:block"})]}),(0,n.jsx)("div",{className:"hidden md:block absolute top-0 left-0 w-8 h-8 border-t-2 border-l-2 border-white/5 rounded-tl-xl group-hover:border-cyan-400/50 transition-colors"}),(0,n.jsx)("div",{className:"hidden md:block absolute bottom-0 right-0 w-8 h-8 border-b-2 border-r-2 border-white/5 rounded-br-xl group-hover:border-cyan-400/50 transition-colors"}),(0,n.jsx)("div",{className:"hidden md:flex absolute top-3 left-10 items-center gap-1 text-[10px] uppercase font-bold text-cyan-700 group-hover:text-cyan-400",children:(null==i?void 0:i.name)||"Cadet"}),(0,n.jsxs)("div",{className:"hidden md:block absolute top-3 right-3 text-xs font-mono font-bold text-cyan-600 group-hover:text-cyan-300",children:[e.xp||0," XP"]}),(0,n.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center w-full z-10 md:space-y-2 md:mt-4",children:[(0,n.jsxs)("div",{className:"hidden md:flex w-28 h-28 rounded-full items-center justify-center bg-gradient-to-b from-white/10 to-transparent group-hover:from-cyan-500/20 transition-all shadow-[0_0_15px_rgba(0,0,0,0.5)] border border-white/5 group-hover:border-cyan-400/30 overflow-hidden relative",children:[(0,n.jsx)("img",{src:(0,o.K)("/images/ships/finalship.png"),className:"w-full h-full object-contain relative z-20 scale-75",alt:"Rocket"}),(0,n.jsx)("div",{className:"absolute top-[22%] left-[26%] w-[48%] h-[30%] z-30 rounded-full overflow-hidden bg-cyan-900/20 scale-75 origin-center",children:(0,n.jsx)(c.Yt,{userData:e,className:"w-full h-full scale-[1.35] translate-y-1"})})]}),(0,n.jsxs)("div",{className:"text-center w-full h-full flex flex-col justify-center md:block md:h-auto",children:[(0,n.jsxs)("h3",{className:"text-white font-bold text-[10px] sm:text-xs md:text-lg leading-tight md:leading-normal w-full px-0.5 break-words md:truncate",children:[null===(t=e.displayName)||void 0===t?void 0:t.split(" ")[0]," ",(0,n.jsx)("span",{className:"md:hidden inline-block w-full",children:null===(r=e.displayName)||void 0===r?void 0:null===(a=r.split(" ")[1])||void 0===a?void 0:a.charAt(0)})," ",(0,n.jsx)("span",{className:"hidden md:inline",children:null===(s=e.displayName)||void 0===s?void 0:s.split(" ").slice(1).join(" ")})," "]}),(0,n.jsx)("p",{className:"hidden md:block text-cyan-600 text-[10px] md:text-xs uppercase tracking-wider font-bold truncate",children:(null===(l=e.spaceship)||void 0===l?void 0:l.name)||"USS Unknown"})]})]})]},e.uid)})})}),(0,n.jsx)(f.M,{children:j.size>0&&(0,n.jsxs)(b.E.div,{initial:{y:200},animate:{y:0},exit:{y:200},className:"fixed bottom-4 left-4 right-4 md:absolute md:bottom-4 md:left-4 md:right-4 bg-cyan-900/90 backdrop-blur-md border border-cyan-500/50 p-4 rounded-xl flex items-center justify-between shadow-2xl z-50 md:z-40",children:[(0,n.jsxs)("div",{className:"flex items-center gap-4",children:[(0,n.jsxs)("div",{className:"flex -space-x-2",children:[Array.from(j).slice(0,3).map(t=>{let a=e.find(e=>e.uid===t);return(0,n.jsx)("div",{className:"w-8 h-8 rounded-full bg-black border border-cyan-500 overflow-hidden",children:a&&(0,n.jsx)(c.Yt,{userData:a,className:"w-full h-full"})},t)}),j.size>3&&(0,n.jsxs)("div",{className:"w-8 h-8 rounded-full bg-cyan-800 border border-cyan-500 flex items-center justify-center text-[10px] font-bold text-white",children:["+",j.size-3]})]}),(0,n.jsxs)("div",{className:"text-white font-bold",children:[j.size," Cadet",1!==j.size?"s":""," Selected"]})]}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)("button",{onClick:()=>{N(new Set),S(!1)},className:"px-4 py-2 text-cyan-300 hover:text-white text-sm font-bold uppercase",children:"Cancel"}),(0,n.jsxs)("button",{onClick:()=>S(!0),className:"px-6 py-2 bg-cyan-500 hover:bg-cyan-400 text-black font-bold rounded-lg uppercase tracking-wider shadow-[0_0_15px_rgba(6,182,212,0.4)] flex items-center gap-2",children:[(0,n.jsx)(x.Z,{size:18,className:"fill-black"}),"Award XP"]})]})]})})]})]}),(0,n.jsx)(f.M,{children:k&&(0,n.jsx)("div",{className:"fixed inset-0 z-50 flex items-end md:items-center justify-center p-4 bg-black/80 backdrop-blur-sm",children:(0,n.jsxs)(b.E.div,{initial:{y:"100%",opacity:0},animate:{y:0,opacity:1},exit:{y:"100%",opacity:0},className:"bg-space-950 border border-cyan-500/30 rounded-t-2xl md:rounded-2xl w-full max-w-sm md:max-w-md overflow-hidden shadow-2xl relative flex flex-col max-h-[85vh]",children:[(0,n.jsx)("button",{onClick:()=>S(!1),className:"absolute top-4 right-4 text-cyan-700 hover:text-white bg-black/50 p-2 rounded-full z-20",children:(0,n.jsx)(d.Z,{size:24})}),(0,n.jsxs)("div",{className:"p-6 text-center border-b border-cyan-900/50 bg-black/20 shrink-0",children:[(0,n.jsx)("div",{className:"flex justify-center -space-x-4 mb-4",children:Array.from(j).slice(0,5).map(t=>{let a=e.find(e=>e.uid===t);return(0,n.jsx)("div",{className:"w-12 h-12 rounded-full bg-black border-2 border-cyan-900 overflow-hidden relative ring-2 ring-black",children:a&&(0,n.jsx)(c.Yt,{userData:a,className:"w-full h-full"})},t)})}),(0,n.jsxs)("h2",{className:"text-xl font-bold text-white mb-1",children:["Awarding ",j.size," Cadet",1!==j.size?"s":""]}),(0,n.jsx)("p",{className:"text-cyan-600 text-xs uppercase font-bold tracking-widest mb-0",children:"Select protocol to transmit"})]}),(0,n.jsxs)("div",{className:"p-4 overflow-y-auto grid grid-cols-1 gap-2 custom-scrollbar bg-black/60",children:[(0,n.jsx)("p",{className:"text-cyan-400 text-xs uppercase tracking-widest font-bold text-center mb-2 opacity-50",children:"Select Protocol"}),0===a.length&&(0,n.jsxs)("div",{className:"text-center p-8 text-gray-500",children:[(0,n.jsx)("p",{children:"No protocols defined."}),(0,n.jsx)("p",{className:"text-xs",children:'Tap "PROTOCOLS" to add some.'})]}),a.map(e=>(0,n.jsxs)("button",{onClick:()=>M(e),className:"\n                                                flex items-center justify-between p-4 rounded-xl border transition-all active:scale-[0.98] group\n                                                ".concat(e.xp>0?"bg-gradient-to-r from-green-900/10 to-transparent border-green-500/20 hover:border-green-400 hover:bg-green-900/20":"bg-gradient-to-r from-red-900/10 to-transparent border-red-500/20 hover:border-red-400 hover:bg-red-900/20","\n                                            "),children:[(0,n.jsx)("span",{className:"font-bold text-white group-hover:tracking-wider transition-all",children:e.label}),(0,n.jsxs)("span",{className:"text-sm font-mono font-bold px-3 py-1 rounded ".concat(e.xp>0?"bg-green-500/20 text-green-300":"bg-red-500/20 text-red-300"," "),children:[e.xp>0?"+":"",e.xp," XP"]})]},e.id))]})]})})}),(0,n.jsx)("audio",{id:"notification-audio",src:(0,o.K)("/sounds/notification.m4a"),preload:"auto"})]})]})}},5802:function(e,t,a){"use strict";a.d(t,{Cn:function(){return i},Ic:function(){return l},W$:function(){return s},Yt:function(){return o}});var n=a(3827),r=a(1657);let s=[{id:"bunny",name:"Space Bunny",src:"/images/avatar/spacebunny.png"},{id:"cat",name:"Cosmic Cat",src:"/images/avatar/spacecat.png"},{id:"raccoon",name:"Rocket Raccoon",src:"/images/avatar/spaceraccoon.png"},{id:"otter",name:"Orbit Otter",src:"/images/avatar/spaceotter.png"},{id:"pup",name:"Pluto Pup",src:"/images/avatar/spacepup.png"},{id:"hamster",name:"Hyper Hamster",src:"/images/avatar/spacehamster.png"},{id:"owl",name:"Omega Owl",src:"/images/avatar/spaceowl.png"},{id:"penguin",name:"Power Penguin",src:"/images/avatar/spacepenguin.png"},{id:"turtle",name:"Turbo Turtle",src:"/images/avatar/spaceturtle.png"}],l=[{id:"p1",name:"Cadet Blue",config:{hue:0,skinHue:200,bgHue:240,bgSat:60,bgLight:50,activeHat:"none",avatarId:"bunny"}},{id:"p2",name:"Crimson Guard",config:{hue:350,skinHue:0,bgHue:0,bgSat:70,bgLight:40,activeHat:"none",avatarId:"cat"}},{id:"p3",name:"Forest Ranger",config:{hue:120,skinHue:100,bgHue:120,bgSat:50,bgLight:60,activeHat:"none",avatarId:"raccoon"}},{id:"p4",name:"Solar Pilot",config:{hue:45,skinHue:60,bgHue:40,bgSat:90,bgLight:70,activeHat:"none",avatarId:"otter"}},{id:"p5",name:"Void Walker",config:{hue:270,skinHue:260,bgHue:280,bgSat:40,bgLight:20,activeHat:"none",avatarId:"pup"}},{id:"p6",name:"Neon Scout",config:{hue:180,skinHue:300,bgHue:320,bgSat:100,bgLight:50,activeHat:"none",avatarId:"cat"}},{id:"p7",name:"Rusty Mechanic",config:{hue:25,skinHue:30,bgHue:15,bgSat:50,bgLight:40,activeHat:"none",avatarId:"raccoon"}},{id:"p8",name:"Ice Specialist",config:{hue:190,skinHue:180,bgHue:200,bgSat:70,bgLight:90,activeHat:"none",avatarId:"bunny"}}],i=[{id:"none",name:"No Hat",src:"",style:""},{id:"hat1",name:"Helmet",src:"/images/hats/helmet1.png",style:"scale-[2.5] translate-y-[45%]"},{id:"hat2",name:"Fedora",src:"/images/hats/hat2.png",style:"scale-[0.9] -translate-y-[40%]"},{id:"hat3",name:"Top Hat",src:"/images/hats/tophat.png",style:"scale-[0.9] -translate-y-[40%]"},{id:"hat4",name:"Cowboy Hat",src:"/images/hats/cowboyhat.png",style:"scale-[0.9] -translate-y-[40%]"},{id:"hat5",name:"Dungan Doves Cap",src:"/images/hats/dungandoves.png",style:"scale-[0.9] -translate-y-[40%]"}],o=e=>{var t,a,l,o,c,d,u,h,m,p,x,f,b,g,v,y,w;let{userData:j,hue:N,skinHue:k,bgHue:S,bgSat:C,bgLight:P,hat:H,avatarId:z,className:I=""}=e,E=null!==(m=null!=N?N:null==j?void 0:null===(t=j.avatar)||void 0===t?void 0:t.hue)&&void 0!==m?m:0,R=null!==(p=null!=k?k:null==j?void 0:null===(a=j.avatar)||void 0===a?void 0:a.skinHue)&&void 0!==p?p:0,L=null!==(x=null!=S?S:null==j?void 0:null===(l=j.avatar)||void 0===l?void 0:l.bgHue)&&void 0!==x?x:260,A=null!==(f=null!=C?C:null==j?void 0:null===(o=j.avatar)||void 0===o?void 0:o.bgSat)&&void 0!==f?f:50,Z=null!==(b=null!=P?P:null==j?void 0:null===(c=j.avatar)||void 0===c?void 0:c.bgLight)&&void 0!==b?b:20,M=null!==(g=null!=z?z:null==j?void 0:null===(d=j.avatar)||void 0===d?void 0:d.avatarId)&&void 0!==g?g:"bunny",O=s.find(e=>e.id===M)||s[0],U=(null==O?void 0:O.src)||"/images/avatar/spacebunny.png",_=null!==(w=null!==(y=null!==(v=null!=H?H:null==j?void 0:j.activeHat)&&void 0!==v?v:null==j?void 0:null===(u=j.avatar)||void 0===u?void 0:u.activeHat)&&void 0!==y?y:null==j?void 0:null===(h=j.avatar)||void 0===h?void 0:h.hat)&&void 0!==w?w:"none",D=i.find(e=>e.id===_),T=null==D?void 0:D.src,X=(null==D?void 0:D.style)||"scale-100";return(0,n.jsxs)("div",{className:"relative ".concat(I),style:{backgroundColor:"hsl(".concat(L,", ").concat(A,"%, ").concat(Z,"%)")},children:[(0,n.jsx)("div",{className:"absolute inset-0 z-0",style:{backgroundColor:"hsl(".concat(R,", 70%, 50%)"),maskImage:"url(".concat((0,r.K)(U),")"),WebkitMaskImage:"url(".concat((0,r.K)(U),")"),maskSize:"cover"}}),(0,n.jsx)("img",{src:(0,r.K)(U),alt:"Avatar",className:"w-full h-full object-cover relative z-10",style:{filter:"hue-rotate(".concat(E,"deg)")}}),T&&(0,n.jsx)("img",{src:(0,r.K)(T),alt:"Accessory",className:"absolute inset-0 z-20 w-full h-full object-cover pointer-events-none transition-transform ".concat(X),onError:e=>console.error("Error loading hat:",T,(0,r.K)(T))})]})}},6678:function(e,t,a){"use strict";a.r(t),a.d(t,{AuthProvider:function(){return u},useAuth:function(){return h}});var n=a(3827),r=a(4090),s=a(7065),l=a(8121),i=a(4499),o=a(7907),c=a(1657);let d=(0,r.createContext)({});function u(e){let{children:t}=e,[a,u]=(0,r.useState)(null),[h,m]=(0,r.useState)(null),[p,x]=(0,r.useState)(!0),f=(0,o.useRouter)();(0,r.useEffect)(()=>{let e=(0,s.Aj)(i.I8,async e=>{if(u(e),e)try{let a=(0,l.JU)(i.db,"users",e.uid),n=await (0,l.QT)(a);if(n.exists()){let t=n.data(),r="andrewpcarlson85@gmail.com"===e.email,s={};if(r&&"teacher"!==t.role&&(console.log("Fixing Admin Role for Legacy User"),t.role="teacher",s.role="teacher"),"teacher"===t.role&&!t.classCode){console.log("Generating Class Code for existing teacher");let e=(0,c.a)();t.classCode=e,s.classCode=e}if(Object.keys(s).length>0)try{await (0,l.pl)(a,s,{merge:!0})}catch(e){console.warn("Could not update user profile in DB",e)}m(t)}else{var t;e.email;let n={uid:e.uid,email:e.email,displayName:e.displayName,photoURL:e.photoURL,role:"teacher",classCode:(0,c.a)(),status:"active",subscriptionStatus:"trial",schoolName:"",location:"earth",spaceship:{name:"SS "+((null===(t=e.displayName)||void 0===t?void 0:t.split(" ")[0])||"Voyager"),color:"text-blue-400",type:"scout",speed:1}};await (0,l.pl)(a,n),m(n)}}catch(t){console.error("Error fetching user data",t),"andrewpcarlson85@gmail.com"===e.email&&(console.log("Using Fallback Admin Profile due to DB error"),m({uid:e.uid,email:e.email,displayName:e.displayName,photoURL:e.photoURL,role:"teacher",status:"active",location:"earth",xp:9999,spaceship:{name:"SS Command (Fallback)",color:"text-yellow-400",type:"fighter",speed:2}}))}else m(null);x(!1)});return()=>e()},[]);let b=async()=>{try{await (0,s.rh)(i.I8,i.Vv)}catch(e){console.error("Login failed",e)}},g=async(e,t)=>{try{await (0,s.e5)(i.I8,e,t)}catch(e){throw console.error("Student Login Failed",e),e}},v=async()=>{await (0,s.w7)(i.I8),m(null),f.push("/")};return(0,n.jsx)(d.Provider,{value:{user:a,userData:h,loading:p,signInWithGoogle:b,signInStudent:g,logout:v},children:t})}let h=()=>(0,r.useContext)(d)},4499:function(e,t,a){"use strict";a.d(t,{I8:function(){return d},Vv:function(){return u},db:function(){return c},qe:function(){return i}});var n=a(6142),r=a(8121),s=a(7065),l=a(3493);let i={apiKey:"AIzaSyDVHiiCHkP-RFOI26cIrD_OijLnw1r3B8Q",authDomain:"spaceadventure-7d540.firebaseapp.com",projectId:"spaceadventure-7d540",storageBucket:"spaceadventure-7d540.firebasestorage.app",messagingSenderId:"546441300465",appId:"1:546441300465:web:28ae387d2bdbb8011a1c50",measurementId:"G-8R9PYL00XH"},o=(0,n.C6)().length>0?(0,n.Mq)():(0,n.ZF)(i),c=(0,r.ad)(o),d=(0,s.v0)(o),u=new s.hJ;(0,l.Gb)().then(e=>{e&&(0,l.IH)(o)})},1657:function(e,t,a){"use strict";a.d(t,{K:function(){return n},a:function(){return r}});let n=e=>{let t=e.startsWith("/")?e:"/".concat(e);return window.location.hostname.includes("github.io")?"https://shootyq.github.io/SpaceAdventure".concat(t):"".concat("").concat(t)},r=()=>{let e="ABCDEFGHJKLMNPQRSTUVWXYZ23456789",t="";for(let a=0;a<6;a++)t+=e.charAt(Math.floor(Math.random()*e.length));return t}},9496:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,a(7461).Z)("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]])},9259:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,a(7461).Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},5879:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,a(7461).Z)("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]])},489:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,a(7461).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},2235:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,a(7461).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},7404:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,a(7461).Z)("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]])},7907:function(e,t,a){"use strict";var n=a(5313);a.o(n,"usePathname")&&a.d(t,{usePathname:function(){return n.usePathname}}),a.o(n,"useRouter")&&a.d(t,{useRouter:function(){return n.useRouter}}),a.o(n,"useSearchParams")&&a.d(t,{useSearchParams:function(){return n.useSearchParams}})},8745:function(e,t,a){"use strict";a.d(t,{M:function(){return b}});var n=a(3827),r=a(4090),s=a(3856),l=a(2435),i=a(4561),o=a(3449);class c extends r.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=this.props.sizeRef.current;e.height=t.offsetHeight||0,e.width=t.offsetWidth||0,e.top=t.offsetTop,e.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function d(e){let{children:t,isPresent:a}=e,s=(0,r.useId)(),l=(0,r.useRef)(null),i=(0,r.useRef)({width:0,height:0,top:0,left:0}),{nonce:d}=(0,r.useContext)(o._);return(0,r.useInsertionEffect)(()=>{let{width:e,height:t,top:n,left:r}=i.current;if(a||!l.current||!e||!t)return;l.current.dataset.motionPopId=s;let o=document.createElement("style");return d&&(o.nonce=d),document.head.appendChild(o),o.sheet&&o.sheet.insertRule('\n          [data-motion-pop-id="'.concat(s,'"] {\n            position: absolute !important;\n            width: ').concat(e,"px !important;\n            height: ").concat(t,"px !important;\n            top: ").concat(n,"px !important;\n            left: ").concat(r,"px !important;\n          }\n        ")),()=>{document.head.removeChild(o)}},[a]),(0,n.jsx)(c,{isPresent:a,childRef:l,sizeRef:i,children:r.cloneElement(t,{ref:l})})}let u=e=>{let{children:t,initial:a,isPresent:s,onExitComplete:o,custom:c,presenceAffectsLayout:u,mode:m}=e,p=(0,l.h)(h),x=(0,r.useId)(),f=(0,r.useCallback)(e=>{for(let t of(p.set(e,!0),p.values()))if(!t)return;o&&o()},[p,o]),b=(0,r.useMemo)(()=>({id:x,initial:a,isPresent:s,custom:c,onExitComplete:f,register:e=>(p.set(e,!1),()=>p.delete(e))}),u?[Math.random(),f]:[s,f]);return(0,r.useMemo)(()=>{p.forEach((e,t)=>p.set(t,!1))},[s]),r.useEffect(()=>{s||p.size||!o||o()},[s]),"popLayout"===m&&(t=(0,n.jsx)(d,{isPresent:s,children:t})),(0,n.jsx)(i.O.Provider,{value:b,children:t})};function h(){return new Map}var m=a(3177);let p=e=>e.key||"";function x(e){let t=[];return r.Children.forEach(e,e=>{(0,r.isValidElement)(e)&&t.push(e)}),t}var f=a(5526);let b=e=>{let{children:t,custom:a,initial:i=!0,onExitComplete:o,presenceAffectsLayout:c=!0,mode:d="sync",propagate:h=!1}=e,[b,g]=(0,m.oO)(h),v=(0,r.useMemo)(()=>x(t),[t]),y=h&&!b?[]:v.map(p),w=(0,r.useRef)(!0),j=(0,r.useRef)(v),N=(0,l.h)(()=>new Map),[k,S]=(0,r.useState)(v),[C,P]=(0,r.useState)(v);(0,f.L)(()=>{w.current=!1,j.current=v;for(let e=0;e<C.length;e++){let t=p(C[e]);y.includes(t)?N.delete(t):!0!==N.get(t)&&N.set(t,!1)}},[C,y.length,y.join("-")]);let H=[];if(v!==k){let e=[...v];for(let t=0;t<C.length;t++){let a=C[t],n=p(a);y.includes(n)||(e.splice(t,0,a),H.push(a))}"wait"===d&&H.length&&(e=H),P(x(e)),S(v);return}let{forceRender:z}=(0,r.useContext)(s.p);return(0,n.jsx)(n.Fragment,{children:C.map(e=>{let t=p(e),r=(!h||!!b)&&(v===C||y.includes(t));return(0,n.jsx)(u,{isPresent:r,initial:(!w.current||!!i)&&void 0,custom:r?void 0:a,presenceAffectsLayout:c,mode:d,onExitComplete:r?void 0:()=>{if(!N.has(t))return;N.set(t,!0);let e=!0;N.forEach(t=>{t||(e=!1)}),e&&(null==z||z(),P(j.current),h&&(null==g||g()),o&&o())},children:e},t)})})}}},function(e){e.O(0,[358,38,911,250,55,971,69,744],function(){return e(e.s=1540)}),_N_E=e.O()}]);