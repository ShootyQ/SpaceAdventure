(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[596],{5497:function(e,t,a){Promise.resolve().then(a.bind(a,5704))},5704:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return y}});var r=a(3827),n=a(4090),s=a(8121),c=a(4499),o=a(6678),i=a(7907),l=a(8792),d=a(3879),u=a(4562),h=a(9369),p=a(94),x=a(489),b=a(8994),m=a(699);function y(){let e=(0,i.useRouter)(),{user:t}=(0,o.useAuth)(),[a,y]=(0,n.useState)(!1),[f,g]=(0,n.useState)(""),[v,w]=(0,n.useState)(""),[j,N]=(0,n.useState)(100),[k,C]=(0,n.useState)("read"),[S,Z]=(0,n.useState)(""),[A,R]=(0,n.useState)(""),[M,I]=(0,n.useState)([]),L=(e,t,a)=>{I(M.map(r=>r.id===e?{...r,[t]:a}:r))},P=(e,t,a)=>{I(M.map(r=>{if(r.id!==e)return r;let n=[...r.options||[]];return n[t]=a,{...r,options:n}}))},z=e=>{I(M.filter(t=>t.id!==e))},E=async a=>{a.preventDefault(),y(!0);try{if(!t)throw Error("Not authenticated");await (0,s.ET)((0,s.hJ)(c.db,"users/".concat(t.uid,"/missions")),{title:f,description:v,type:k,contentUrl:"watch"===k?S:null,contentText:"read"===k?A:null,questions:M,xpReward:Number(j),teacherId:t.uid,createdAt:(0,s.Bt)()}),e.push("/teacher/missions")}catch(e){console.error("Error creating mission:",e),alert("Failed to create mission. Check console.")}finally{y(!1)}};return(0,r.jsx)("div",{className:"min-h-screen bg-space-950 p-6 font-mono text-cyan-400",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto mb-20",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4 mb-8",children:[(0,r.jsx)(l.default,{href:"/teacher/missions",className:"p-2 rounded-full border border-cyan-500/30 hover:bg-cyan-900/20 text-cyan-500",children:(0,r.jsx)(d.Z,{size:20})}),(0,r.jsx)("h1",{className:"text-3xl font-bold uppercase tracking-widest text-white",children:"New Mission Protocol"})]}),(0,r.jsxs)("form",{onSubmit:E,className:"space-y-8",children:[(0,r.jsxs)("div",{className:"bg-black/40 border border-cyan-900/50 rounded-xl p-6 backdrop-blur-sm",children:[(0,r.jsx)("h2",{className:"text-white font-bold text-xl mb-4 border-b border-cyan-900/50 pb-2",children:"1. Mission Overview"}),(0,r.jsxs)("div",{className:"grid gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs uppercase tracking-wider text-cyan-600 mb-2",children:"Mission Title"}),(0,r.jsx)("input",{required:!0,type:"text",value:f,onChange:e=>g(e.target.value),className:"w-full bg-cyan-950/20 border border-cyan-800 rounded p-3 text-white focus:border-cyan-500 outline-none",placeholder:"e.g. Operation: Solar Wind"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs uppercase tracking-wider text-cyan-600 mb-2",children:"Briefing (Description)"}),(0,r.jsx)("textarea",{required:!0,value:v,onChange:e=>w(e.target.value),className:"w-full bg-cyan-950/20 border border-cyan-800 rounded p-3 text-white focus:border-cyan-500 outline-none h-24",placeholder:"Brief description of the learning objective..."})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs uppercase tracking-wider text-cyan-600 mb-2",children:"XP Reward"}),(0,r.jsx)("input",{type:"number",value:j,onChange:e=>N(Number(e.target.value)),className:"w-full bg-cyan-950/20 border border-cyan-800 rounded p-3 text-white focus:border-cyan-500 outline-none"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs uppercase tracking-wider text-cyan-600 mb-2",children:"Content Type"}),(0,r.jsxs)("div",{className:"flex bg-cyan-950/30 rounded p-1 border border-cyan-800",children:[(0,r.jsxs)("button",{type:"button",onClick:()=>C("read"),className:"flex-1 flex items-center justify-center gap-2 py-2 rounded transition-all ".concat("read"===k?"bg-cyan-600 text-black font-bold":"hover:bg-cyan-900/50"),children:[(0,r.jsx)(u.Z,{size:16})," Reading"]}),(0,r.jsxs)("button",{type:"button",onClick:()=>C("watch"),className:"flex-1 flex items-center justify-center gap-2 py-2 rounded transition-all ".concat("watch"===k?"bg-cyan-600 text-black font-bold":"hover:bg-cyan-900/50"),children:[(0,r.jsx)(h.Z,{size:16})," Video"]})]})]})]}),"watch"===k?(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs uppercase tracking-wider text-cyan-600 mb-2",children:"Video URL (YouTube)"}),(0,r.jsx)("input",{type:"url",value:S,onChange:e=>Z(e.target.value),className:"w-full bg-cyan-950/20 border border-cyan-800 rounded p-3 text-white focus:border-cyan-500 outline-none",placeholder:"https://youtube.com/watch?v=..."})]}):(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs uppercase tracking-wider text-cyan-600 mb-2",children:"Reading Material"}),(0,r.jsx)("textarea",{value:A,onChange:e=>R(e.target.value),className:"w-full bg-cyan-950/20 border border-cyan-800 rounded p-3 text-white focus:border-cyan-500 outline-none h-48 font-sans",placeholder:"Enter the lesson text here..."})]})]})]}),(0,r.jsxs)("div",{className:"bg-black/40 border border-cyan-900/50 rounded-xl p-6 backdrop-blur-sm",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6 border-b border-cyan-900/50 pb-2",children:[(0,r.jsx)("h2",{className:"text-white font-bold text-xl",children:"2. Assessment"}),(0,r.jsxs)("button",{type:"button",onClick:()=>{I([...M,{id:Date.now().toString(),text:"",type:"mc",options:["","","",""],correctAnswer:""}])},className:"flex items-center gap-2 text-cyan-400 hover:text-white text-sm uppercase tracking-wider font-bold",children:[(0,r.jsx)(p.Z,{size:16})," Add Question"]})]}),(0,r.jsx)("div",{className:"space-y-6",children:M.map((e,t)=>(0,r.jsxs)("div",{className:"bg-cyan-950/20 border border-cyan-800/50 rounded-lg p-4 relative",children:[(0,r.jsx)("button",{type:"button",onClick:()=>z(e.id),className:"absolute top-4 right-4 text-red-500 hover:text-red-400",children:(0,r.jsx)(x.Z,{size:16})}),(0,r.jsxs)("div",{className:"grid gap-4 pr-8",children:[(0,r.jsxs)("div",{className:"grid grid-cols-[1fr,200px] gap-4",children:[(0,r.jsx)("input",{required:!0,type:"text",value:e.text,onChange:t=>L(e.id,"text",t.target.value),className:"bg-black/30 border border-cyan-800 rounded p-2 text-white focus:border-cyan-500 outline-none",placeholder:"Question #".concat(t+1)}),(0,r.jsxs)("select",{value:e.type,onChange:t=>L(e.id,"type",t.target.value),className:"bg-black/30 border border-cyan-800 rounded p-2 text-cyan-400 outline-none",children:[(0,r.jsx)("option",{value:"mc",children:"Multiple Choice"}),(0,r.jsx)("option",{value:"tf",children:"True / False"}),(0,r.jsx)("option",{value:"sort",children:"Sort Order"})]})]}),"tf"===e.type&&(0,r.jsx)("div",{className:"flex gap-4",children:["True","False"].map(t=>(0,r.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,r.jsx)("input",{type:"radio",name:"q-".concat(e.id),checked:e.correctAnswer===t,onChange:()=>L(e.id,"correctAnswer",t),className:"accent-cyan-500"}),(0,r.jsx)("span",{className:"text-white",children:t})]},t))}),"mc"===e.type&&(0,r.jsx)("div",{className:"space-y-2 pl-4 border-l-2 border-cyan-900",children:e.options.map((t,a)=>(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("input",{type:"radio",name:"q-".concat(e.id,"-ans"),checked:e.correctAnswer===t&&""!==t,onChange:()=>L(e.id,"correctAnswer",t),className:"accent-cyan-500"}),(0,r.jsx)("input",{required:!0,type:"text",value:t,onChange:t=>P(e.id,a,t.target.value),className:"flex-grow bg-black/30 border border-cyan-800/50 rounded p-2 text-sm text-gray-300 focus:border-cyan-500 outline-none",placeholder:"Option ".concat(a+1)})]},a))}),"sort"===e.type&&(0,r.jsxs)("div",{className:"space-y-2 pl-4 border-l-2 border-cyan-900",children:[(0,r.jsx)("p",{className:"text-xs text-cyan-600 mb-2",children:"Enter items in the CORRECT order. Details will be shuffled for cadets."}),e.options.map((t,a)=>(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("span",{className:"text-cyan-700 font-bold",children:a+1}),(0,r.jsx)("input",{required:!0,type:"text",value:t,onChange:t=>P(e.id,a,t.target.value),className:"flex-grow bg-black/30 border border-cyan-800/50 rounded p-2 text-sm text-gray-300 focus:border-cyan-500 outline-none",placeholder:"Item ".concat(a+1)})]},a))]})]})]},e.id))})]}),(0,r.jsxs)("button",{type:"submit",disabled:a,className:"fixed bottom-6 right-6 flex items-center gap-4 bg-cyan-600 hover:bg-cyan-500 text-black font-bold px-8 py-4 rounded-full shadow-lg shadow-cyan-900/50 transition-all z-50 disabled:opacity-50",children:[a?(0,r.jsx)(b.Z,{className:"animate-spin"}):(0,r.jsx)(m.Z,{size:24}),"PUBLISH MISSION"]})]})]})})}},6678:function(e,t,a){"use strict";a.r(t),a.d(t,{AuthProvider:function(){return u},useAuth:function(){return h}});var r=a(3827),n=a(4090),s=a(7065),c=a(8121),o=a(4499),i=a(7907),l=a(1657);let d=(0,n.createContext)({});function u(e){let{children:t}=e,[a,u]=(0,n.useState)(null),[h,p]=(0,n.useState)(null),[x,b]=(0,n.useState)(!0),m=(0,i.useRouter)();(0,n.useEffect)(()=>{let e=(0,s.Aj)(o.I8,async e=>{if(u(e),e)try{let a=(0,c.JU)(o.db,"users",e.uid),r=await (0,c.QT)(a);if(r.exists()){let t=r.data(),n="andrewpcarlson85@gmail.com"===e.email,s={};if(n&&"teacher"!==t.role&&(console.log("Fixing Admin Role for Legacy User"),t.role="teacher",s.role="teacher"),"teacher"===t.role&&!t.classCode){console.log("Generating Class Code for existing teacher");let e=(0,l.a)();t.classCode=e,s.classCode=e}if(Object.keys(s).length>0)try{await (0,c.pl)(a,s,{merge:!0})}catch(e){console.warn("Could not update user profile in DB",e)}p(t)}else{var t;e.email;let r={uid:e.uid,email:e.email,displayName:e.displayName,photoURL:e.photoURL,role:"teacher",classCode:(0,l.a)(),status:"active",subscriptionStatus:"trial",schoolName:"",location:"earth",spaceship:{name:"SS "+((null===(t=e.displayName)||void 0===t?void 0:t.split(" ")[0])||"Voyager"),color:"text-blue-400",type:"scout",speed:1}};await (0,c.pl)(a,r),p(r)}}catch(t){console.error("Error fetching user data",t),"andrewpcarlson85@gmail.com"===e.email&&(console.log("Using Fallback Admin Profile due to DB error"),p({uid:e.uid,email:e.email,displayName:e.displayName,photoURL:e.photoURL,role:"teacher",status:"active",location:"earth",xp:9999,spaceship:{name:"SS Command (Fallback)",color:"text-yellow-400",type:"fighter",speed:2}}))}else p(null);b(!1)});return()=>e()},[]);let y=async()=>{try{await (0,s.rh)(o.I8,o.Vv)}catch(e){console.error("Login failed",e)}},f=async(e,t)=>{try{await (0,s.e5)(o.I8,e,t)}catch(e){throw console.error("Student Login Failed",e),e}},g=async()=>{await (0,s.w7)(o.I8),p(null),m.push("/")};return(0,r.jsx)(d.Provider,{value:{user:a,userData:h,loading:x,signInWithGoogle:y,signInStudent:f,logout:g},children:t})}let h=()=>(0,n.useContext)(d)},4499:function(e,t,a){"use strict";a.d(t,{I8:function(){return d},Vv:function(){return u},db:function(){return l},qe:function(){return o}});var r=a(6142),n=a(8121),s=a(7065),c=a(3493);let o={apiKey:"AIzaSyDVHiiCHkP-RFOI26cIrD_OijLnw1r3B8Q",authDomain:"spaceadventure-7d540.firebaseapp.com",projectId:"spaceadventure-7d540",storageBucket:"spaceadventure-7d540.firebasestorage.app",messagingSenderId:"546441300465",appId:"1:546441300465:web:28ae387d2bdbb8011a1c50",measurementId:"G-8R9PYL00XH"},i=(0,r.C6)().length>0?(0,r.Mq)():(0,r.ZF)(o),l=(0,n.ad)(i),d=(0,s.v0)(i),u=new s.hJ;(0,c.Gb)().then(e=>{e&&(0,c.IH)(i)})},1657:function(e,t,a){"use strict";a.d(t,{K:function(){return r},a:function(){return n}});let r=e=>{let t=e.startsWith("/")?e:"/".concat(e);return window.location.hostname.includes("github.io")?"https://shootyq.github.io/SpaceAdventure".concat(t):"".concat("").concat(t)},n=()=>{let e="ABCDEFGHJKLMNPQRSTUVWXYZ23456789",t="";for(let a=0;a<6;a++)t+=e.charAt(Math.floor(Math.random()*e.length));return t}},7461:function(e,t,a){"use strict";a.d(t,{Z:function(){return c}});var r=a(4090),n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),c=(e,t)=>{let a=(0,r.forwardRef)((a,c)=>{let{color:o="currentColor",size:i=24,strokeWidth:l=2,absoluteStrokeWidth:d,className:u="",children:h,...p}=a;return(0,r.createElement)("svg",{ref:c,...n,width:i,height:i,stroke:o,strokeWidth:d?24*Number(l)/Number(i):l,className:["lucide","lucide-".concat(s(e)),u].join(" "),...p},[...t.map(e=>{let[t,a]=e;return(0,r.createElement)(t,a)}),...Array.isArray(h)?h:[h]])});return a.displayName="".concat(e),a}},3879:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(7461).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},4562:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(7461).Z)("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]])},8994:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(7461).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},94:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(7461).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},699:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(7461).Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]])},489:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(7461).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},9369:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(7461).Z)("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]])},8792:function(e,t,a){"use strict";a.d(t,{default:function(){return n.a}});var r=a(5250),n=a.n(r)},7907:function(e,t,a){"use strict";var r=a(5313);a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(t,{useSearchParams:function(){return r.useSearchParams}})}},function(e){e.O(0,[358,38,911,250,971,69,744],function(){return e(e.s=5497)}),_N_E=e.O()}]);